(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[111],{rb31:function(a,e,t){"use strict";var n=t("g09b"),d=t("tAuX");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,t("T2oS");var l=n(t("W9HT")),i=n(t("p0pE")),o=n(t("eHn4")),r=n(t("2Taf")),s=n(t("vZ4D")),c=n(t("l4Ni")),u=n(t("ujKo")),g=n(t("rlhR")),m=n(t("MhPg"));t("y8nQ");var f,p,h,_,C=n(t("Vl3Y")),b=t("MuoO"),v=d(t("q1tI")),y=t("+n12"),L=n(t("hh8c")),w=n(t("CkN6")),I=n(t("RTFr")),S=n(t("fjb3")),T=t("UWOa"),V=n(t("3lWI")),D=["".concat((0,y.sldComLanguage)("\u5ba1\u6838\u901a\u8fc7\u540e\uff0c\u7533\u8bf7\u54c1\u724c\u548c\u5206\u7c7b\u7684\u7ed1\u5b9a\u5173\u7cfb\u751f\u6548\uff0c\u53d1\u5e03\u5546\u54c1\u7684\u65f6\u5019\u9009\u62e9\u8be5\u5206\u7c7b\u5373\u53ef\u9009\u62e9\u8be5\u54c1\u724c\u3002\u5206\u7c7b\u9700\u7ed1\u5b9a\u5230\u7b2c\u4e09\u7ea7\u3002"))],x=y.list_com_page_size_10,O=(f=(0,b.connect)(function(a){var e=a.store;return{store:e}}),p=C.default.create(),f(h=p((_=function(a){function e(a){var t;return(0,r.default)(this,e),t=(0,c.default)(this,(0,u.default)(e).call(this,a)),t.cur_edit_id="",t.cur_sele_cat=[],t.getGoodsCategroy=function(a){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.props.dispatch,d=t.state.addData,l="manage/getVendorGoodsCategoryById";n({type:l,payload:{categoryId:a,grade:e},callback:function(n){for(var l in n.data.map(function(a){null==a.children?a.isLeaf=!0:a.isLeaf=!1,delete a.children}),d)if("category"==d[l].name){if(1==e)d[l].data=n.data;else if(2==e){var i=d[l].data.filter(function(e){return e.categoryId==a})[0];i.children=n.data}else if(3==e){var o=d[l].data.filter(function(e){return e.categoryId==a})[0];o.children=n.data}break}t.setState({addData:d})}})},t.handleGoodsCategroy=function(a){t.cur_sele_cat=a},t.loadData=function(a){var e=a[a.length-1];e.loading=!0;var n=t.props.dispatch,d=t.state.addData,l="manage/getVendorGoodsCategoryById",i=1*a[a.length-1].grade+1;n({type:l,payload:{categoryId:e.categoryId,grade:i},callback:function(a){a.data.length>0?(a.data.map(function(a){null==a.children?a.isLeaf=!0:a.isLeaf=!1,delete a.children}),e.children=a.data):e.isLeaf=!0,e.loading=!1,d[2].data=JSON.parse(JSON.stringify(d[2].data)),t.setState({addData:d})}})},t.uploadImg=function(a,e){var n=t.state.addData;if(void 0!=a.file.status&&"error"!=a.file.status){for(var d in n)n[d].name==e&&(n[d].fileList=a.fileList,n[d].img_info=void 0!=a.file.response&&a.fileList.length>0&&void 0!=a.file.response.data?a.file.response.data:[]);t.setState({addData:n})}},t.uploadImgPre=function(a){var e="";e=void 0!=a.response&&void 0!=a.response.data?a.response.data.url:a.url,t.viewImg(!0,e)},t.editBrand=function(a){var e=t.state.addData;t.props.dispatch({type:"store/get_brand_detail",payload:{brandId:a.brandId},callback:function(n){if(200==n.state){for(var d in e)if("image"==e[d].name){var l=[],i={};i.uid=a.brandId,i.name=a.image,i.status="done",i.url=a.imageUrl,l.push(i),e[d].fileList=l,e[d].img_info.path=a.image}else if("category"==e[d].name){var o=n.data.brandAndCateVOList.filter(function(a){return a.categoryId==n.data.goodsCateId1})[0];o.children.map(function(a){a.isLeaf=!1,a.grade=2});var r=o.children.filter(function(a){return a.categoryId==n.data.goodsCateId2})[0];r.isLeaf=!1;var s=r.children.filter(function(a){return a.categoryId==n.data.goodsCateId3})[0];s.isLeaf=!0,e[d].initialValue=[n.data.goodsCateId1,n.data.goodsCateId2,n.data.goodsCateId3],n.data.brandAndCateVOList.map(function(a){a.isLeaf=!1,a.grade=1}),e[d].data=n.data.brandAndCateVOList,t.cur_sele_cat=[{categoryId:n.data.goodsCateId1},{categoryId:n.data.goodsCateId2},{categoryId:n.data.goodsCateId3}]}else e[d].initialValue=a[e[d].name];t.cur_edit_id=a.brandId,t.setState({type:"edit",title:"".concat((0,y.sldComLanguage)("\u7f16\u8f91\u54c1\u724c")),addData:e,modalVisible:!0})}else(0,y.failTip)(n.msg)}})},t.addBrand=function(){var a=t.state.addData;for(var e in a)"single_checkbox"==a[e].type?a[e].initialValue=!1:"upload_img_upload"==a[e].type?(a[e].fileList=[],a[e].img_info={}):a[e].initialValue="";t.setState({modalVisible:!0,type:"add",title:"".concat((0,y.sldComLanguage)("\u6dfb\u52a0\u54c1\u724c")),addData:a})},t.get_list=function(a){t.setState({initLoading:!0});var e=t.props.dispatch;e({type:"store/get_brand_apply_lists",payload:a,callback:function(e){t.setState({initLoading:!1}),200==e.state&&((null==e.data.list||0==e.data.list.length)&&t.state.params.current>1?(a.current=a.current-1,t.get_list(a)):t.setState({data:e.data}))}})},t.handleSelectRows=function(a,e){t.setState({selectedRows:a,selectedRowKeys:e})},t.handleTablePagination=function(a,e,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var d=t.state.formValues,l=(0,y.sldHandlePaginationData)(a,e,n,d);x=l.pageSize,t.setState({params:l}),t.get_list(l)},t.resizeTable=function(a,e,n,d){var l=(0,y.dragSldTableColumn)(a,e,d);t.setState((0,o.default)({},n,l))},t.sldHandleCancle=function(){t.setState({modalVisible:!1})},t.operateBrand=function(a,e){var n=t.props.dispatch,d="",l={brandId:a};"edit"==e?(d="store/edit_brand",l=a):"del"==e&&(d="store/del_brand",l={brandId:a}),n({type:d,payload:l,callback:function(a){200==a.state?((0,y.sucTip)(a.msg),t.get_list(t.state.params),t.setState({modalVisible:!1})):(0,y.failTip)(a.msg),t.setState({submiting:!1})}})},t.sldHandleConfirm=function(a){var e=t.state,n=e.type,d=e.addData,l=t.props.dispatch,i=(0,g.default)(t),o={};for(var r in o.brandName=a.brandName,o.brandDesc=a.brandDesc,d)if("image"==d[r].name){if(void 0==d[r].img_info.path)return(0,y.failTip)("".concat((0,y.sldComLanguage)("\u8bf7\u4e0a\u4f20\u54c1\u724cLOGO"))),!1;o.image=d[r].img_info.path}if(t.cur_sele_cat.length<3)return(0,y.failTip)("".concat((0,y.sldComLanguage)("\u5206\u7c7b\u5fc5\u987b\u9009\u5230\u4e09\u7ea7\u624d\u53ef\u4ee5"))),!1;o.categoryId=t.cur_sele_cat[2].categoryId,t.setState({submiting:!0}),"edit"==n?(o.brandId=t.cur_edit_id,t.operateBrand(o,"edit")):l({type:"store/apply_brand",payload:o,callback:function(a){200==a.state?((0,y.sucTip)(a.msg),i.get_list({pageSize:x}),t.setState({modalVisible:!1,formValues:{},search_con:""})):(0,y.failTip)(a.msg),t.setState({submiting:!1})}})},t.viewImg=function(a){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";t.setState({preview_img:e,preview_alt_con:n,show_preview_modal:a})},t.sldSearch=function(a){var e=t.state.formValues;e.brandName=a,t.setState({formValues:e,params:{pageSize:x}}),t.get_list((0,i.default)({pageSize:x},e))},t.sldSearChange=function(a){t.setState({search_con:a.target.value})},t.sldSearClear=function(){t.setState({search_con:""}),t.sldSearch("")},t.handleToggleTip=function(){var a=t.state.sld_show_tip;t.setState({sld_show_tip:!a,scroll_h:a?0:42})},t.state={scroll_h:42,search_con:"",initLoading:!1,submiting:!1,show_preview_modal:!1,preview_img:"",preview_alt_con:"",modalTableVisible:!1,data:{},selectedRows:[],selectedRowKeys:[],title:"",type:"add",params:{pageSize:x},upload_img_info:{},addData:[{type:"input",label:"".concat((0,y.sldComLanguage)("\u54c1\u724c\u540d\u79f0")),name:"brandName",placeholder:"".concat((0,y.sldComLanguage)("\u8bf7\u8f93\u5165\u54c1\u724c\u540d\u79f0")),extra:"".concat((0,y.sldComLanguage)("\u6700\u591a\u8f93\u516520\u4e2a\u5b57")),initialValue:"",maxLength:20,rules:[{required:!0,whitespace:!0,message:"".concat((0,y.sldComLanguage)("\u8bf7\u8f93\u5165\u54c1\u724c\u540d\u79f0"))}]},{type:"upload_img_upload",label:"".concat((0,y.sldComLanguage)("\u54c1\u724cLOGO")),name:"image",extra:"".concat((0,y.sldComLanguage)("\u5efa\u8bae\u4e0a\u4f20\u5bbd153*\u9ad854\u7684\u56fe\u7247")),fileList:[],img_info:{},upload_name:"file",required:!0,upload_url:T.apiUrl+"v3/oss/common/upload?source=sellerBrand",uploadPreview:t.uploadImgPre,uploadChange:function(a){return t.uploadImg(a,"image")},initialValue:""},{type:"cascader_common_load",label:"".concat((0,y.sldComLanguage)("\u54c1\u724c\u5206\u7c7b")),name:"category",placeholder:"".concat((0,y.sldComLanguage)("\u8bf7\u9009\u62e9\u8981\u7ed1\u5b9a\u7684\u5546\u54c1\u5206\u7c7b")),extra:"".concat((0,y.sldComLanguage)("\u5fc5\u987b\u9009\u5230\u7b2c\u4e09\u7ea7\u5206\u7c7b")),initialValue:"",data:[],fieldNames:{label:"categoryName",value:"categoryId",children:"children"},onChange:t.handleGoodsCategroy,loadData:t.loadData,rules:[{required:!0,message:"".concat((0,y.sldComLanguage)("\u8bf7\u9009\u62e9\u8981\u7ed1\u5b9a\u7684\u5546\u54c1\u5206\u7c7b"))}]},{type:"textarea",label:"".concat((0,y.sldComLanguage)("\u54c1\u724c\u63cf\u8ff0")),extra:"".concat((0,y.sldComLanguage)("\u6700\u591a\u8f93\u5165200\u4e2a\u5b57")),disable:!0,name:"brandDesc",placeholder:"".concat((0,y.sldComLanguage)("\u8bf7\u8f93\u5165\u54c1\u724c\u63cf\u8ff0")),initialValue:"",maxLength:200}],formValues:{},columns:[{title:" ",dataIndex:"brandId",align:"center",width:55,render:function(a,e,n){return(0,y.getTableNum)(t.state.params,x,n)}},{title:"".concat((0,y.sldComLanguage)("\u54c1\u724c\u540d\u79f0")),dataIndex:"brandName",align:"center",width:100},{title:"".concat((0,y.sldComLanguage)("\u54c1\u724cLOGO")),dataIndex:"imageUrl",align:"center",width:100,render:function(a){return(0,y.getSldComImg)(a,160,60,85,30)}},{title:"".concat((0,y.sldComLanguage)("\u54c1\u724c\u5206\u7c7b")),dataIndex:"goodsCategoryPath",align:"center",width:100},{title:"".concat((0,y.sldComLanguage)("\u54c1\u724c\u63cf\u8ff0")),dataIndex:"brandDesc",align:"center",width:100,render:function(a){return(0,y.getSldComShowMoreTtex)(a,50,200)}},{title:"".concat((0,y.sldComLanguage)("\u5ba1\u6838\u72b6\u6001")),dataIndex:"stateValue",align:"center",width:80},{title:"".concat((0,y.sldComLanguage)("\u62d2\u7edd\u7406\u7531")),dataIndex:"failReason",align:"center",width:100,render:function(a){return a?(0,y.getSldComShowMoreTtex)(a,50,200):"--"}},{title:"".concat((0,y.sldComLanguage)("\u64cd\u4f5c")),align:"center",width:80,render:function(a,e){return v.default.createElement(v.Fragment,null,1!=e.state&&v.default.createElement(v.Fragment,null,(0,y.sldtbaleOpeBtnText)("".concat((0,y.sldComLanguage)("\u7f16\u8f91")),function(){return t.editBrand(e)}),v.default.createElement("span",{className:L.default.splitLine})),(0,y.sldPopConfirmDiy)("leftBottom","".concat((0,y.sldComLanguage)("\u5220\u9664\u540e\u4e0d\u53ef\u6062\u590d\uff0c\u662f\u5426\u786e\u5b9a\u5220\u9664")),function(){return t.operateBrand(e.brandId,"del")},"".concat((0,y.sldComLanguage)("\u786e\u5b9a")),"".concat((0,y.sldComLanguage)("\u53d6\u6d88")),(0,y.sldtbaleOpeBtnText)("".concat((0,y.sldComLanguage)("\u5220\u9664")),function(){return null})))}}]},t}return(0,m.default)(e,a),(0,s.default)(e,[{key:"componentDidMount",value:function(){this.get_list({pageSize:x}),this.getGoodsCategroy(0,1)}},{key:"render",value:function(){var a=this,e=this.state,t=e.selectedRows,n=e.search_con,d=e.columns,i=e.initLoading,o=e.data,r=e.submiting,s=e.addData,c=e.modalVisible,u=e.title,g=e.preview_img,m=e.preview_alt_con,f=e.show_preview_modal,p=e.sld_show_tip,h=e.scroll_h;return v.default.createElement("div",{className:L.default.common_page,style:{flex:1}},v.default.createElement(V.default,{type:1,title:"".concat((0,y.sldComLanguage)("\u54c1\u724c\u7ba1\u7406")),handleToggleTip:function(){return a.handleToggleTip()}}),(0,y.showMoreHelpTip)("",D,8,p),(0,y.getSldEmptyH)(10),v.default.createElement("div",{className:L.default.operate_bg},(0,y.sldIconBtn)(function(){return a.addBrand()},"".concat((0,y.sldComLanguage)("\u65b0\u589e\u54c1\u724c")),7,7),(0,y.sldSearchValClear)("".concat((0,y.sldComLanguage)("\u8bf7\u8f93\u5165\u54c1\u724c\u540d\u79f0")),291,this.sldSearch,"".concat((0,y.sldComLanguage)("\u641c\u7d22")),n,this.sldSearChange,this.sldSearClear,65)),v.default.createElement(l.default,{spinning:i},v.default.createElement(w.default,{totalHeight:document.body.clientHeight-150-h-15,selectedRows:t,data:o,rowKey:"brandId",isCheck:!1,columns:d,onSelectRow:this.handleSelectRows,onSldHandleSeleRow:this.onSldHandleSeleRow,onChange:function(e,t,n){return a.handleTablePagination(e,t,n,"main")},resizeTable:function(e,t){return a.resizeTable(e,t,"columns",d)},isColumnResize:!0})),v.default.createElement(I.default,{title:u,submiting:r,width:500,modalVisible:c,sldHandleConfirm:function(e){return a.sldHandleConfirm(e)},sldHandleCancle:this.sldHandleCancle,formItemLayoutModal:y.formItemLayoutModal,content:s}),v.default.createElement(S.default,{img:g,show_preview_modal:f,modal_width:300,preview_alt_con:m,closePreviewModal:function(){return a.viewImg(!1)}}))}}]),e}(v.Component),h=_))||h)||h);e.default=O}}]);
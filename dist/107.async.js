(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[107],{DKDZ:function(e,t,a){"use strict";var n=a("g09b"),i=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var l=n(a("W9HT"));a("g9YV");var s=n(a("wCAj"));a("sRBo");var d=n(a("kaz8"));a("BoS7");var o=n(a("Sdc0"));a("5Dmo");var r=n(a("3S7+"));a("5NDa");var c=n(a("5rEg"));a("giR+");var u=n(a("fyUT")),p=n(a("d6i3")),g=n(a("1l/V")),f=n(a("p0pE")),m=n(a("2Taf")),h=n(a("vZ4D")),_=n(a("l4Ni")),v=n(a("ujKo")),y=n(a("rlhR")),I=n(a("MhPg"));a("y8nQ");var w=n(a("Vl3Y"));a("OaEy");var L,C,S,V,b=n(a("2fM7")),k=a("MuoO"),E=i(a("q1tI")),N=a("k82f"),P=a("+n12"),x=a("wGLq"),F=n(a("hh8c")),O=a("UWOa"),T=n(a("nVqQ")),D=n(a("KzAW")),J=n(a("BDXA")),R=n(a("fjb3")),q=(b.default.Option,w.default.Item),A="",H=(L=(0,k.connect)(function(e){var t=e.point,a=e.global,n=e.common;return{point:t,global:a,common:n}}),C=w.default.create(),L(S=C((V=function(e){function t(e){var a;(0,m.default)(this,t),a=(0,_.default)(this,(0,v.default)(t).call(this,e)),a.img_item={type:"upload_img_upload",label:"".concat((0,P.sldComLanguage)("\u56fe\u7247")),name:"image",extra:"".concat((0,P.sldComLanguage)("\u5efa\u8bae\u5c3a\u5bf8800px*800px\u7684\u65b9\u5f62\u56fe\u7247,\u6700\u5927\u9650\u5236")).concat(O.uploadLimit).concat((0,P.sldComLanguage)("M,\u5728\u4fdd\u8bc1\u56fe\u7247\u8d28\u91cf\u7684\u60c5\u51b5\u4e0b\u56fe\u7247\u8d8a\u5c0f\u52a0\u8f7d\u6548\u679c\u8d8a\u597d,\u6700\u591a\u53ef\u4e0a\u4f206\u5f20")),fileList:[],upload_name:"file",upload_url:O.apiUrl+"v3/oss/common/upload?source=goods",initialValue:"",img_succ_info:{},required:!0,item_height:140},a.point_label_lists=[],a.sel_label_data=[],a.reserveInfoList={type:"add_reserve_info",label:"".concat((0,P.sldComLanguage)("\u7528\u6237\u9884\u7559\u4fe1\u606f")),name:"reserveInfoList",placeholder:"",width:250,sel_data:[],initialValue:[],addReserveInfo:function(){return a.addReserveInfo()},handleReserveInfo:function(e,t,n){return a.handleReserveInfo(e,t,n)},delReserveInfo:function(e){return a.delReserveInfo(e)}},a.handleGoodsType=function(e){var t=a.state.other_data;if(t=t.filter(function(e){return"reserveInfoList"!=e.name}),2==e){var n=JSON.parse(JSON.stringify(a.reserveInfoList));n.addReserveInfo=function(){A.addReserveInfo()},n.handleReserveInfo=function(e,t,a){A.handleReserveInfo(e,t,a)},n.delReserveInfo=function(e){A.delReserveInfo(e)},t.push(n)}a.setState({cur_goods_type:e,other_data:t})},a.addReserveInfo=function(){var e=a.state.other_data,t=e.filter(function(e){return"reserveInfoList"==e.name})[0];5==t.sel_data.length?(0,P.failTip)("".concat((0,P.sldComLanguage)("\u7528\u6237\u9884\u7559\u4fe1\u606f\u6700\u591a\u6dfb\u52a05\u6761"),"\uff5e")):(t.sel_data.push({reserveName:"",reserveType:"".concat((0,P.sldComLanguage)("\u624b\u673a\u53f7")),isRequired:0,key:(new Date).valueOf()}),t.item_height=70+40*t.sel_data.length,a.setState({other_data:e}))},a.handleReserveInfo=function(e,t,n){var i=a.state.other_data,l=i.filter(function(e){return"reserveInfoList"==e.name})[0],s=l.sel_data.filter(function(e){return e.key==t})[0];s[n]="isRequired"==n?e?1:0:e,a.setState({other_data:i})},a.delReserveInfo=function(e){var t=a.state.other_data,n=t.filter(function(e){return"reserveInfoList"==e.name})[0];n.sel_data=n.sel_data.filter(function(t){return t.key!=e}),n.item_height=70+40*n.sel_data.length,a.setState({other_data:t})},a.handleChange=function(e,t,n){a.setState({filteredInfo:t,sortedInfo:n})},a.handleSelLabel=function(e,t,n){var i=[];e.length>0&&void 0!=n.allCheckedNodes.length&&n.allCheckedNodes.length&&n.allCheckedNodes.map(function(e){if(void 0!=e.children&&e.children.length)e.children.map(function(e){var t=void 0!=e.node?e.node.key:e.key;i.push(t)});else{var t=void 0!=e.node?e.node.key:e.key;i.push(t)}}),a.sel_label_data=i},a.get_common_setting=function(){var e=a.props.dispatch;e({type:"common/getSetting",payload:{str:"integral_conversion_ratio"},callback:function(e){200==e.state&&a.setState({convert_rate:1*e.data[0].value})}})},a.validatorIntegral=function(e,t,n){var i=a.state.convert_rate;t%i>0&&n("".concat((0,P.sldComLanguage)("\u9700\u4e3a")).concat(i).concat((0,P.sldComLanguage)("\u7684\u6574\u6570\u500d"))),n()},a.validatorMarketPrice=function(e,t,a,n){t&&t<=n&&a("".concat((0,P.sldComLanguage)("\u5e94\u5927\u4e8e\u73b0\u91d1\u4ef7"))),a()},a.getPointLabels=function(){var e=a.props.dispatch,t=a.state.goods_base_data,n="point/get_point_label_list",i={pageSize:P.list_com_page_more};e({type:n,payload:i,callback:function(e){if(200==e.state){var n=t.filter(function(e){return"labelId"==e.name})[0];for(var i in e.data.list)e.data.list[i].key=e.data.list[i].labelId,e.data.list[i].value=e.data.list[i].labelName,e.data.list[i].title=e.data.list[i].labelName,null!=e.data.list[i].children&&e.data.list[i].children.length>0?e.data.list[i].children.map(function(e){e.key=e.labelId,e.value=e.labelName,e.title=e.labelName}):e.data.list[i].disableCheckbox=!0;a.point_label_lists=e.data.list,n.data=e.data.list,a.setState({goods_base_data:t})}}})},a.addSpec=function(e){var t=a.state.spec_set_data;if(t[0].show_data.length>=P.commonSetting.specLimit)return(0,P.failTip)("".concat((0,P.sldComLanguage)("\u6700\u591a\u8bbe\u7f6e")).concat(P.commonSetting.specLimit).concat((0,P.sldComLanguage)("\u7ec4\u89c4\u683c\u9879"))),!1;var n=t.filter(function(e){return"goods_spec_sele"==e.name})[0];n.is_add_spec=e,a.setState({spec_set_data:t})},a.addSpecValue=function(e,t){var n=a.state.spec_set_data,i=n[0].show_data.filter(function(e){return e.specId==t});if(i[0].showValList.length>=P.commonSetting.specValLimit)return(0,P.failTip)("".concat((0,P.sldComLanguage)("\u6bcf\u4e2a\u89c4\u683c\u9879\u6700\u591a\u8bbe\u7f6e")).concat(P.commonSetting.specValLimit).concat((0,P.sldComLanguage)("\u4e2a\u89c4\u683c\u503c"))),!1;i[0].is_add_spec_val=e;var l=n[0].sel_data.filter(function(e){return e.specId==t});l[0].is_add_spec_val=e,a.setState({spec_set_data:n})},a.handleDelAddSpec=function(e){var t=a.state.spec_set_data,n=t[0];if("spec"==e.type){var i=n.show_data.filter(function(t){return t.specId==e.specId})[0];i.sele_flag=!1,void 0!=i.valueList.length&&i.valueList.length>0&&i.valueList.map(function(e){e.sele_flag=!1}),i.is_img_spec&&a.initSpuGoodsImgData(),n.show_data=n.show_data.filter(function(t){return t.specId!=e.specId})}else{var l=n.sel_data.filter(function(t){return t.specId==e.specId})[0],s=l.valueList.filter(function(t){return t.specValueId==e.specValueId})[0];s.sele_flag=!1;var d=n.show_data.filter(function(t){return t.specId==e.specId})[0];d.valueList=JSON.parse(JSON.stringify(l.valueList)),d.showValList=d.showValList.filter(function(t){return t.specValueId!=e.specValueId}),d.is_img_spec&&a.operateSpecImg("del",{specValueId:e.specValueId})}a.setState({spec_set_data:t},function(){A.getCalcDEscartes(t[0].show_data)})},a.setImgSpec=function(e,t){var n=a.state,i=n.spec_set_data,l=n.is_set_img_spec,s=n.goods_img_data,d=i[0];for(var o in d.show_data)if(d.show_data[o].specId==t)if(d.show_data[o].is_img_spec=e.target.checked,d.sel_data[o].is_img_spec=e.target.checked,l=e.target.checked,1==e.target.checked){if(s=[],d.show_data[o].showValList.length>0)for(var r in d.show_data[o].showValList){var c=d.show_data[o].showValList[r];s.push(JSON.parse(JSON.stringify(a.img_item)));var u=s[s.length-1];u.label=c.specValue,u.name="image"+c.specValueId,u.specId=c.specId,u.specValueId=c.specValueId,u.specValue=c.specValue,u.extra_param=c,u.fileList=[],u.uploadPreview=function(e){A.uploadImgPre(e)},u.uploadChange=function(e,t){A.uploadImg(e,"image"+t.specValueId)}}a.setState({goods_img_data:s})}else a.initSpuGoodsImgData();else d.show_data[o].is_img_spec=!1;a.setState({spec_set_data:i,is_set_img_spec:l})},a.operateSpecImg=function(e,t){var n=a.state.goods_img_data;if("add"==e){n.push(JSON.parse(JSON.stringify(a.img_item)));var i=n[n.length-1];i.label=t.specValue,i.name="image"+t.specValueId,i.specId=t.specId,i.specValueId=t.specValueId,i.specValue=t.specValue,i.extra_param=t,i.fileList=[],i.uploadPreview=function(e){A.uploadImgPre(e)},i.uploadChange=function(e,t){A.uploadImg(e,"image"+t.specValueId)}}else if("edit"==e){var l=n.filter(function(e){return e.specValueId==t.specValueId})[0];l.label=t.specValue,l.name="image"+t.specValueId,l.specId=t.specId,l.specValueId=t.specValueId,l.specValue=t.specValue,l.extra_param=t}else if("del"==e&&(n=n.filter(function(e){return e.specValueId!=t.specValueId}),0==n.length))return a.initSpuGoodsImgData(),!1;a.setState({goods_img_data:n})},a.initSpuGoodsImgData=function(){var e=a.state.goods_img_data;e=[JSON.parse(JSON.stringify(a.img_item))];var t=e[e.length-1];t.label="".concat((0,P.sldComLanguage)("\u56fe\u7247")),t.name="image",t.specId="",t.specValueId="",t.specValue="",t.extra_param={},t.fileList=[],t.uploadPreview=function(e){A.uploadImgPre(e)},t.uploadChange=function(e){A.uploadImg(e,"image")},a.setState({goods_img_data:e})},a.handleSpecFocus=function(e){var t=a.state.spec_set_data;if("spec"==e.type){var n=t[0],i=n.sel_data.filter(function(t){return t.specId==e.specId})[0];i.is_editing=!0}a.setState({spec_set_data:t})},a.handleSetOpenFlag=function(e){var t=a.state.spec_set_data,n=t[0],i=n.show_data.filter(function(t){return t.specId==e.specId})[0];if("spec"==e.type)i.open_flag=e.flag;else{var l=i.valueList.filter(function(t){return t.specValueId==e.specValueId})[0],s=i.showValList.filter(function(t){return t.specValueId==e.specValueId})[0];l.open_flag=e.flag,s.open_flag=e.flag}a.setState({spec_set_data:t})},a.specTimeStamp=(new Date).getTime(),a.handleSpecChange=function(e){if(1*(new Date).getTime()-a.specTimeStamp<5)return!1;a.specTimeStamp=(new Date).getTime();var t=a.props.dispatch,n=a.state.spec_set_data;if(0==e.sel.length)return!1;var i=e.sel;if("spec"==e.type){if(i.length>6)return(0,P.failTip)("".concat((0,P.sldComLanguage)("\u6700\u591a\u8f93\u51656\u4e2a\u5b57"))),!1;var l=n[0],s=l.sel_data.filter(function(e){return e.specName==i});if(void 0!=s.length&&s.length>0){if(s[0].sele_flag=!0,l.is_add_spec=!1,l.is_editing=!1,"add"==e.operate)l.show_data.push((0,f.default)({},JSON.parse(JSON.stringify((0,f.default)({},s[0],{is_add_spec_val:!0}))),{showValList:[]}));else{var d=l.sel_data.filter(function(t){return t.specId==e.specId})[0];d.sele_flag=!1;var o=l.show_data.filter(function(t){return t.specId==e.specId})[0];for(var r in void 0!=o.valueList.length&&o.valueList.length>0&&o.valueList.map(function(e){e.sele_flag=!1}),l.show_data)if(l.show_data[r].specId==e.specId){l.show_data[r]=(0,f.default)({},JSON.parse(JSON.stringify(s[0])),{showValList:[]});break}}a.setState({spec_set_data:n},function(){a.getCalcDEscartes(n[0].show_data),a.handleSetOpenFlag({type:"spec",flag:!1,specId:s[0].specId}),e.ref&&e.ref["spec_"+s[0].specId].blur()})}else t({type:"point/add_goods_spec",payload:{specName:i},callback:function(t){if(200==t.state){l.is_add_spec=!1,l.is_editing=!1;var s={specId:t.data,specName:i,sele_flag:!0,valueList:[],showValList:[],open_flag:!1};if(l.sel_data.push(s),"add"==e.operate)l.show_data.push(JSON.parse(JSON.stringify((0,f.default)({},s,{is_add_spec_val:!0}))));else for(var d in l.show_data)if(l.show_data[d].specId==e.specId){l.show_data[d]=JSON.parse(JSON.stringify(s));break}a.setState({spec_set_data:n},function(){A.getCalcDEscartes(n[0].show_data)})}else(0,P.failTip)(t.msg)}})}else{if(i.length>10)return(0,P.failTip)("".concat((0,P.sldComLanguage)("\u6700\u591a\u8f93\u516510\u4e2a\u5b57"))),!1;var c=n[0].show_data.filter(function(t){return t.specId==e.specId}),u=n[0].sel_data.filter(function(t){return t.specId==e.specId}),p=c[0].valueList.filter(function(e){return e.specValue==i});if(void 0!=p.length&&p.length>0){if(c[0].is_add_spec_val=!1,p[0].sele_flag=!0,"add"==e.operate)c[0].showValList.push(JSON.parse(JSON.stringify(p[0])));else{var g=c[0].valueList.filter(function(t){return t.specValueId==e.specValueId})[0];for(var m in g.sele_flag=!1,c[0].showValList)if(c[0].showValList[m].specValueId==e.specValueId){c[0].showValList[m]=JSON.parse(JSON.stringify(p[0]));break}}if(c[0].is_img_spec){var h={};h.specId=p[0].specId,h.specValueId=p[0].specValueId,h.specValue=p[0].specValue,a.operateSpecImg(e.operate,h)}u[0].valueList=JSON.parse(JSON.stringify(c[0].valueList)),a.setState({spec_set_data:n},function(){a.getCalcDEscartes(n[0].show_data),a.handleSetOpenFlag({type:"spec_val",flag:!1,specId:u[0].specId,specValueId:p[0].specValueId}),e.ref&&e.ref["spec_val_"+p[0].specValueId].blur()})}else{if(0==c[0].storeId)return(0,P.failTip)("".concat((0,P.sldComLanguage)("\u5e73\u53f0\u9884\u8bbe\u7684\u89c4\u683c\u4e0d\u53ef\u4ee5\u81ea\u884c\u6dfb\u52a0"))),!1;t({type:"point/add_goods_spec_val",payload:{specId:e.specId,specValue:i},callback:function(t){if(200==t.state){c[0].is_add_spec_val=!1;var l={specId:e.specId,specValue:i,sele_flag:!0,specValueId:t.data};if(c[0].valueList.push(l),"add"==e.operate)c[0].showValList.push(JSON.parse(JSON.stringify(l)));else for(var s in c[0].showValList)if(c[0].showValList[s].specValueId==e.specValueId){c[0].showValList[s]=JSON.parse(JSON.stringify(l));break}if(c[0].is_img_spec){var d={};d.specId=l.specId,d.specValueId=l.specValueId,d.specValue=l.specValue,a.operateSpecImg(e.operate,d)}a.setState({spec_set_data:n},function(){A.getCalcDEscartes(n[0].show_data)})}else(0,P.failTip)(t.msg)}})}}},a.get_spec_list=function(){var e=a.props.dispatch,t=a.state,n=t.spec_set_data,i=t.query,l=t.loading;e({type:"point/get_goods_spec_list",payload:{pageSize:P.list_com_page_more},callback:function(e){for(var t in n)"goods_spec_sele"==n[t].name&&(200==e.state?n[t].sel_data=e.data.list:n[t].sel_data=[]);void 0!=i.id&&i.id>0&&(l=!0),a.setState({spec_set_data:n,loading:l},function(){void 0!=i.id&&i.id>0&&A.get_goods_detail(i.id)})}})},a.get_goods_detail=function(e){var t=a.props.dispatch,n=a.state,i=n.goods_base_data,l=n.initEditorContent,s=n.sele_goods_cat_data,d=n.goods_img_data,o=n.spec_data_table,r=n.spu_data_table,c=n.other_data,u=n.spec_set_data,m=n.goods_video_data;d=[],t({type:"point/get_goods_detail",payload:{integralGoodsId:e},callback:function(){var e=(0,g.default)(p.default.mark(function e(t){var n,g,h,_,v,y,I,w,L,C,S;return p.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(200==t.state){for(n=t.data,g=[],t.data.labelList.map(function(e){A.sel_label_data.push(e.labelId),g.push(e.labelName)}),h=0;h<i.length;h++)"labelId"==i[h].name?i[h].initialValue=g:(i[h].initialValue=n[i[h].name],"isVirtualGoods"==i[h].name&&(i[h].disabled=!0));for(S in null!=n.specInfoList&&void 0!=n.specInfoList.length&&n.specInfoList.length>0?(n.specInfoList.map(function(e,t){var a=u[0].sel_data.filter(function(t){return t.specId==e.specId});if(void 0!=a&&void 0!=a.length&&a.length>0){a[0].sele_flag=!0,a[0].is_img_spec=1==e.isMain;var i=[];n.specInfoList[t].specValueList.map(function(t,n){var l=a[0].valueList.filter(function(e){return e.specValueId==t.specValueId});if(void 0!=l&&void 0!=l.length&&l.length>0&&(l[0].sele_flag=!0,i.push((0,f.default)({},l[0]))),1==e.isMainSpec){d.push(JSON.parse(JSON.stringify(A.img_item)));var s=d[d.length-1];s.label=t.specValue,s.name="image"+t.specValueId,s.specId=e.specId,s.specValueId=t.specValueId,s.specValue=t.specValue,s.extra_param={specValueId:t.specValueId},s.fileList=[],t.imageList.map(function(e){var t={};t.uid=e.image,t.thumbUrl=e.imageUrl,t.status="done",t.response={},t.response.state=200,t.response.data={path:e.image,url:e.imageUrl},s.fileList.push(t)}),s.uploadPreview=function(e){A.uploadImgPre(e)},s.uploadChange=function(e,t){A.uploadImg(e,"image"+t.specValueId)}}}),u[0].show_data.push((0,f.default)({},JSON.parse(JSON.stringify(a[0])),{showValList:i,is_img_spec:1==e.isMainSpec}))}}),_=[],v=0,n.productList.map(function(e,t){v+=1;var a={};a.barCode=e.barCode,a.integralPrice=e.integralPrice,a.productPrice=e.cashPrice,a.productStock=e.productStock,a.height=e.height,a.isDefault=e.isDefault,a.length=e.length,a.key=v,a.marketPrice=e.marketPrice,a.productCode=e.productCode,a.state=e.state,a.productStockWarning=e.productStockWarning,a.weight=e.weight,a.width=e.width,a.specValIdArray=[],a.specValIdArray=e.specValueIds.split(","),a.spec_info=[],a.specValIdArray.map(function(e,t){for(var i={sele_flag:!0},l=0;l<n.specInfoList.length;l++){var s=n.specInfoList[l].specValueList.filter(function(t){return t.specValueId==e});if(s.length>0){i.specId=n.specInfoList[l].specId,i.specName=n.specInfoList[l].specName,i.specValue=s[0].specValue,i.specValueId=s[0].specValueId,i.specImage=s[0].imageList;break}}a.spec_info.push((0,f.default)({},i))}),_.push((0,f.default)({},a))}),o.list=_):(y=r.list[0],I=n.productList[0],y.marketPrice=I.marketPrice,y.integralPrice=I.integralPrice,y.goodsPrice=I.cashPrice,y.goodsStock=I.productStock,y.weight=I.weight,y.length=I.length,y.width=I.width,y.height=I.height,y.stockWarning=I.productStockWarning,y.productCode=I.productCode,y.barCode=I.barCode),0!=n.imageList.length&&(d=[JSON.parse(JSON.stringify(A.img_item))],w=d[0],w.label="".concat((0,P.sldComLanguage)("\u56fe\u7247")),w.name="image",w.specId="",w.specValueId="",w.specValue="",w.extra_param={},w.fileList=[],n.imageList.map(function(e){var t={};t.uid=e.image,t.thumbUrl=e.imageUrl,t.status="done",t.response={},t.response.state=200,t.response.data={path:e.image,url:e.imageUrl},w.fileList.push(t)}),w.uploadPreview=function(e){A.uploadImgPre(e)},w.uploadChange=function(e){A.uploadImg(e,"image")}),n.goodsVideo&&(L={},L.uid=n.goodsVideo,L.thumbUrl=n.goodsVideoUrl,L.status="done",L.response={},L.response.state=200,L.response.data={path:n.goodsVideo,url:n.goodsVideoUrl},m[0].fileList=[L]),c=c.filter(function(e){return"reserveInfoList"!=e.name}),2==n.isVirtualGoods&&(C=JSON.parse(JSON.stringify(a.reserveInfoList)),C.addReserveInfo=function(){A.addReserveInfo()},C.handleReserveInfo=function(e,t,a){A.handleReserveInfo(e,t,a)},C.delReserveInfo=function(e){A.delReserveInfo(e)},void 0!=n.reserveList.length&&n.reserveList.length>0&&(n.reserveList.map(function(e,t){C.sel_data.push({reserveName:e.reserveName,reserveType:(0,x.reserveInfoLimitType)().filter(function(t){return t.key==e.reserveType})[0]["value"],isRequired:e.isRequired,key:(new Date).valueOf()+t})}),C.item_height=70+40*C.sel_data.length),c.push(C)),c)"sellNow"==c[S].name?c[S].initialValue=2:c[S].initialValue=n[c[S].name];l=(0,P.quillEscapeToHtml)(t.data.goodsDetails),a.setState({loading:!1,sele_goods_cat_data:s,goods_base_data:i,initEditorContent:l,goods_img_data:d,goods_video_data:m,spec_set_data:u,spu_data_table:r,other_data:c,spec_data_table:o,cur_goods_type:n.isVirtualGoods,show_radio_flag:!0,initEditorFlag:!0},function(){A.getCalcDEscartes(u[0].show_data)})}case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}()})},a.handleSpecSele=function(e,t){var n=a.state.spec_set_data,i=n[0].sel_data,l=i.filter(function(e){return e.id==t.specId})[0];for(var s in l.sele_id_array=l.sele_id_array||[],l.attrList)l.attrList[s].id==t.id&&(l.attrList[s].sele_flag=e,e?l.sele_id_array.push(t.id):l.sele_id_array=l.sele_id_array.filter(function(e){return e!=t.id}));a.getCalcDEscartes(i),a.setState({spec_set_data:n})},a.getCalcDEscartes=function(e){var t=[];for(var n in e)void 0!=e[n].showValList.length&&e[n].showValList.length>0&&t.push(e[n].showValList);if(0==t.length)return!1;var i=(0,P.calcDescartes)(t);a.getAllSpecTableData(i)},a.getAllSpecTableData=function(e){var t=0,n=a.state,i=n.spec_set_data,l=n.columns_spec,s=n.spec_data_table,d=i[0].show_data.filter(function(e){return e.showValList.length>0});for(var o in l=l.filter(function(e){return-1==e.dataIndex.indexOf("spec_info")}),d)for(var r in t++,l)if("marketPrice"==l[r].dataIndex){l.splice(r,0,{title:d[o].specName,dataIndex:"spec_info["+o+"]",align:"center",width:70,render:function(e,t){return E.default.createElement("span",null,e.specValue)}});break}for(var c=[],u=function(a){var n={},i=[];1==t?i.push(e[a].specValueId):e[a].length>0&&e[a].map(function(e){i.push(e.specValueId)}),n.specValIdArray=i,n.spec_info=1==t?[e[a]]:e[a],n.key=a+1,n.state=1,n.isDefault=0==a?1:0,n.marketPrice="",n.productPrice="",n.integralPrice="",n.productStock="",n.productStockWarning="",n.weight=1,n.length=1,n.width=1,n.height=1,n.productCode="",n.barCode="",c.push(n)},p=0;p<e.length;p++)u(p);var g=[],f=JSON.parse(JSON.stringify(s));g=0==f.list.length?JSON.parse(JSON.stringify(c)):a.combineSpecListData(c,f.list),s.list=JSON.parse(JSON.stringify(g)),a.setState({spec_data_table:s,columns_spec:l})},a.combineSpecListData=function(e,t){for(var a=0;a<e.length;a++)for(var n=0;n<t.length;n++)if((0,P.isEqualArray)(e[a].specValIdArray,t[n].specValIdArray)){var i=(0,f.default)({},t[n],{specValIdArray:JSON.parse(JSON.stringify(e[a].specValIdArray)),spec_info:JSON.parse(JSON.stringify(e[a].spec_info)),key:e[a].key});e[a]=JSON.parse(JSON.stringify(i));break}return e},a.viewImg=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";a.setState({preview_img:t,preview_alt_con:n,show_preview_modal:e})},a.uploadImgPre=function(e){a.viewImg(!0,e.url||e.thumbUrl)},a.uploadImg=function(e,t){var n=a.state.goods_img_data;if(void 0!=e.file.status&&"error"!=e.file.status){var i=e.fileList[e.fileList.length-1];for(var l in void 0!=i.response&&void 0!=i.response.state&&255==i.response.state&&((0,P.failTip)(i.response.msg),e.fileList.pop()),n)if(n[l].name==t){n[l].fileList=e.fileList;break}a.setState({goods_img_data:n})}},a.uploadVideo=function(e,t){var n=a.state.goods_video_data;if(void 0!=e.file.status&&"error"!=e.file.status){for(var i in n)if(n[i].name==t){n[i].fileList=e.fileList;break}a.setState({goods_video_data:n})}},a.delVideo=function(){var e=a.state.goods_video_data;e[0].fileList=[],a.setState({goods_video_data:e})},a.uploadImgSpec=function(e,t){var n=e.fileList,i=a.state.spec_set_data,l=i[0].sel_data,s=l.filter(function(e){return e.id==t.specId})[0];for(var d in s.attrList)s.attrList[d].id==t.id&&(s.attrList[d].fileList=n);a.setState({spec_set_data:i})},a.handleSelectRows=function(e,t){a.setState({selectedRows:e,selectedRowKeys:t})},a.handleSaveAllData=function(){a.setState({getEditorContentFlag:!0})},a.getEditorContent=function(e){a.saveData(e),a.setState({getEditorContentFlag:!1})},a.saveData=function(e){var t=a.props.dispatch,n=a.state,i=n.query,l=n.spec_data_table,s=n.goods_img_data,d=n.goods_video_data,o=n.spec_set_data,r=n.cur_goods_type,c=n.other_data;a.props.form.validateFieldsAndScroll(function(n,u){if(n){if(void 0!=n.labelId||void 0!=n.goodsName||void 0!=n.goodsBrief)return void a.setState({top_nav_step:1},function(){a.refs.scrollbars.scrollTop(0)});if(2==r)for(var p in n)if(p.indexOf("reserveName")>-1)return void a.setState({top_nav_step:1},function(){void 0!=a.refs.other_info_position.offsetTop&&a.refs.other_info_position.offsetTop&&a.refs.scrollbars.scrollTop(a.refs.other_info_position.offsetTop+80)});if(void 0!=n.goodsPrice||void 0!=n.goodsStock)return void a.setNavStep(2);for(var g in n)if(g.indexOf("productPrice")+g.indexOf("productStock")>-2)return void a.setNavStep(2)}else{var f={};if(f.isVirtualGoods=u.isVirtualGoods,2==f.isVirtualGoods){var m=c.filter(function(e){return"reserveInfoList"==e.name})[0]["sel_data"];m.length&&(f.reserveInfoList=[],m.map(function(e){f.reserveInfoList.push({reserveName:e.reserveName,reserveType:(0,x.reserveInfoLimitType)().filter(function(t){return t.value==e.reserveType})[0]["key"],isRequired:e.isRequired})}))}if(l.list.length>0){var h=0;for(var _ in l.list)if(l.list[_].isDefault){h+=1;break}if(0==h)return(0,P.failTip)("\u591a\u89c4\u683c\u5546\u54c1\u9700\u8981\u8bbe\u7f6e\u9ed8\u8ba4\u9009\u4e2d\u6570\u636e"),!1}if(d[0].fileList.length>0&&(f.goodsVideo=d[0].fileList[0].response.data.path),f.goodsName=u.goodsName,f.goodsBrief=u.goodsBrief,f.sellNow=u.sellNow,f.storeIsRecommend=u.storeIsRecommend,f.isVatInvoice=u.isVatInvoice,f.relatedTemplateIdTop=u.relatedTemplateIdTop,f.relatedTemplateIdBottom=u.relatedTemplateIdBottom,f.productList=[],f.labelIds=a.sel_label_data.join(","),l.list.length>0){f.specInfoList=[];var v=function(e){var t=o[0].show_data[e],a={};a.specId=t.specId,a.specName=t.specName,a.isMainSpec=void 0!=t.is_img_spec&&t.is_img_spec?1:0,a.specValueList=[];var n=function(e){var n={};if(n.specValueId=t.showValList[e].specValueId,n.specValue=t.showValList[e].specValue,void 0!=t.is_img_spec&&t.is_img_spec){n.imageList=[];var i=s.filter(function(a){return a.specValueId==t.showValList[e].specValueId})[0].fileList;if(0==i.length)return(0,P.failTip)("".concat((0,P.sldComLanguage)("\u89c4\u683c\u503c\u4e3a"))+t.showValList[e].specValue+"".concat((0,P.sldComLanguage)("\u7684\u56fe\u7247\u7ec4,\u81f3\u5c11\u4e0a\u4f20\u4e00\u5f20\u5546\u54c1\u56fe\u7247"))),{v:{v:!1}};for(var l in i){var d=i[l].response;200==d.state&&n.imageList.push({image:d.data.path,isMain:0==l?1:2})}}a.specValueList.push(n)};for(var i in t.showValList){var l=n(i);if("object"===typeof l)return l.v}f.specInfoList.push(a)};for(var y in o[0].show_data){var I=v(y);if("object"===typeof I)return I.v}for(var w in l.list){var L=l.list[w],C={specInfoList:[]};for(var S in L.spec_info){var V={};V.specId=L.spec_info[S].specId,V.specName=L.spec_info[S].specName,V.specValueId=L.spec_info[S].specValueId,V.specValue=L.spec_info[S].specValue,C.specInfoList.push(V)}C.marketPrice=L.marketPrice,C.integralPrice=L.integralPrice,C.cashPrice=L.productPrice,C.productStock=L.productStock,C.productStockWarning=L.productStockWarning,C.weight=L.weight,C.length=L.length,C.width=L.width,C.height=L.height,C.productCode=L.productCode,C.barCode=L.barCode,C.state=L.state,C.isDefault=L.isDefault,f.productList.push(C)}}else f.marketPrice=u.marketPrice,f.integralPrice=u.integralPrice,f.cashPrice=u.goodsPrice,f.productStock=u.goodsStock,f.productStockWarning=u.stockWarning,f.weight=u.weight,f.length=u.length,f.width=u.width,f.height=u.height,f.productCode=u.productCode?u.productCode:"",f.barCode=u.barCode;f.goodsDetails=e,f.imageList=[];var b=s[0].fileList;if(0==b.length)return(0,P.failTip)("".concat((0,P.sldComLanguage)("\u81f3\u5c11\u4e0a\u4f20\u4e00\u5f20\u5546\u54c1\u56fe\u7247"))),!1;for(var y in b){var k=b[y].response;200==k.state&&f.imageList.push({image:k.data.path,isMain:0==y?1:2})}var E="";void 0!=i.id&&i.id>0?(f.integralGoodsId=1*i.id,E="point/edit_goods"):E="point/add_goods",a.setState({pageLoading:!0}),t({type:E,payload:f,callback:function(e){A.setState({pageLoading:!1}),200==e.state?((0,P.sucTip)(e.msg,1),setTimeout(function(){A.props.history.goBack()},500)):(0,P.failTip)(e.msg)}})}})},a.setNavStep=function(e){var t=a.state.top_nav_step;t!=e&&a.setState({top_nav_step:e},function(){a.refs.scrollbars.scrollTop(0)})},a.backPre=function(){a.props.history.goBack()},a.operateCurNavStep=function(e){a.setState({top_nav_step:e})},A=(0,y.default)(a);var n=e.form.getFieldDecorator;return a.state={initEditorFlag:!1,getEditorContentFlag:!1,initEditorContent:"",convert_rate:0,is_set_img_spec:!1,top_nav_step:1,step:1,modalVisible:!1,submiting:!1,commonTop:60,loading:!1,pageLoading:!1,show_table_modal_add:!1,modalSldAddVisible:!1,tablesldSAddTitle:"".concat((0,P.sldComLanguage)("\u6dfb\u52a0")),search_add_modal_width:500,search_modal_width:600,tableTitle:"",cur_type:"",cur_operate_type:"",modalTableVisible:!1,cur_data:[],sele_goods_cat_data:[],goods_fileList:[],description:"",goodsCategoryId:"",goods_cat:[[],[],[]],filteredInfo:null,sortedInfo:null,modal_width:800,show_preview_modal:!1,preview_img:"",preview_alt_con:"",price:0,bprice:0,cost:0,query:e.location.query,screentW:"1000",screentH:"1000",selectedRows:[],selectedRowKeys:[],columns_spec:[{title:" ",dataIndex:"key",align:"center",width:30,render:function(e,t,a){return a+1}},{title:E.default.createElement("div",{style:{position:"relative"}},E.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),"\u5546\u54c1\u539f\u4ef7"),dataIndex:"marketPrice",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("marketPrice".concat(t.key),{initialValue:e,rules:[{required:!0,message:"".concat((0,P.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))},{validator:function(e,a,n){return A.validatorMarketPrice(e,a,n,t.productPrice)}}]})(E.default.createElement(u.default,{min:.01,max:9999999,precision:2,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"marketPrice",t.key)}})))}},{title:E.default.createElement("div",{style:{position:"relative"}},E.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),"\u79ef\u5206"),dataIndex:"integralPrice",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("integralPrice".concat(t.key),{initialValue:e,rules:t.productPrice?[{validator:function(e,t,a){return A.validatorIntegral(e,t,a)}}]:[{required:!0,message:"".concat((0,P.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))},{validator:function(e,t,a){return A.validatorIntegral(e,t,a)}}]})(E.default.createElement(u.default,{min:t.productPrice?0:1,max:99999999,precision:0,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"integralPrice",t.key)}})))}},{title:E.default.createElement("div",{style:{position:"relative"}},E.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),"\u73b0\u91d1(\xa5)"),dataIndex:"productPrice",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("productPrice".concat(t.key),{initialValue:e,rules:t.integralPrice?[]:[{required:!0,message:"".concat((0,P.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))}]})(E.default.createElement(u.default,{min:t.integralPrice?0:.01,max:9999999,precision:2,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"productPrice",t.key)}})))}},{title:E.default.createElement("div",{style:{position:"relative"}},E.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),(0,P.sldComLanguage)("\u5e93\u5b58")),dataIndex:"productStock",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("productStock".concat(t.key),{initialValue:e,rules:[{required:!0,message:"".concat((0,P.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))}]})(E.default.createElement(u.default,{min:0,max:99999999,precision:0,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"productStock",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u91cd\u91cf(KG)")),dataIndex:"weight",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("weight".concat(t.key),{initialValue:e||1})(E.default.createElement(u.default,{min:.001,max:999999.999,precision:3,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"weight",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u957f(CM)")),dataIndex:"length",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("length".concat(t.key),{initialValue:e||1})(E.default.createElement(u.default,{min:.001,max:999999.999,precision:3,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"length",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u5bbd(CM)")),dataIndex:"width",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("width".concat(t.key),{initialValue:e||1})(E.default.createElement(u.default,{min:.001,max:999999.999,precision:3,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"width",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u9ad8(CM)")),dataIndex:"height",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("height".concat(t.key),{initialValue:e||1})(E.default.createElement(u.default,{min:.001,max:999999.999,precision:3,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"height",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u9884\u8b66\u503c")),dataIndex:"productStockWarning",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("productStockWarning".concat(t.key),{initialValue:e})(E.default.createElement(u.default,{min:0,max:300,precision:0,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"productStockWarning",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u8d27\u53f7")),dataIndex:"productCode",align:"center",width:150,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("productCode".concat(t.key),{initialValue:e})(E.default.createElement(c.default,{maxLength:20,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e.target.value,"productCode",t.key)}})))}},{title:E.default.createElement("div",{style:{position:"relative"}},(0,P.sldComLanguage)("\u6761\u5f62\u7801"),E.default.createElement(r.default,{placement:"bottomLeft",title:(0,P.sldComLanguage)("\u865a\u62df\u5546\u54c1\u65e0\u9700\u586b\u5199")},E.default.createElement("div",{style:{right:-15,top:2,position:"absolute"}},(0,P.sldSvgIcon)("#bfbbba",14,14,"wen")))),dataIndex:"barCode",align:"center",width:150,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("barCode".concat(t.key),{initialValue:e})(E.default.createElement(c.default,{maxLength:30,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e.target.value,"barCode",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u542f\u7528")),dataIndex:"state",align:"center",width:60,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("state".concat(t.key),{valuePropName:"checked",initialValue:1==e})(E.default.createElement(o.default,{style:{width:"100%"},disabled:1==t.isDefault,onChange:function(e){return a.handleFieldChange(e?1:2,"state",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u9ed8\u8ba4\u9009\u4e2d")),dataIndex:"isDefault",align:"center",width:60,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("isDefault".concat(t.key),{valuePropName:"checked",initialValue:1==e})(E.default.createElement(d.default,{onChange:function(e){return a.handleFieldChangeDefault(e.target.checked?1:0,"isDefault",t.key)}})))}}],columns_spu:[{title:" ",dataIndex:"key",align:"center",width:30,render:function(e,t,a){return a+1}},{title:E.default.createElement("div",{style:{position:"relative"}},E.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),(0,P.sldComLanguage)("\u5546\u54c1\u539f\u4ef7")),dataIndex:"marketPrice",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("marketPrice",{initialValue:e,rules:[{required:!0,message:"".concat((0,P.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))},{validator:function(e,a,n){return A.validatorMarketPrice(e,a,n,t.goodsPrice)}}]})(E.default.createElement(u.default,{min:.01,max:9999999,precision:2,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e,"marketPrice",t.key)}})))}},{title:E.default.createElement("div",{style:{position:"relative"}},E.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),(0,P.sldComLanguage)("\u79ef\u5206")),dataIndex:"integralPrice",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("integralPrice",{initialValue:e,rules:t.goodsPrice?[{validator:function(e,t,a){return A.validatorIntegral(e,t,a)}}]:[{required:!0,message:"".concat((0,P.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))},{validator:function(e,t,a){return A.validatorIntegral(e,t,a)}}]})(E.default.createElement(u.default,{min:t.goodsPrice?0:1,max:99999999,precision:0,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e,"integralPrice",t.key)}})))}},{title:E.default.createElement("div",{style:{position:"relative"}},E.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),(0,P.sldComLanguage)("\u73b0\u91d1(\xa5)")),dataIndex:"goodsPrice",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("goodsPrice",{initialValue:e,rules:t.integralPrice?[]:[{required:!0,message:"".concat((0,P.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))}]})(E.default.createElement(u.default,{min:t.integralPrice?0:.01,max:9999999,precision:2,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e,"goodsPrice",t.key)}})))}},{title:E.default.createElement("div",{style:{position:"relative"}},E.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),(0,P.sldComLanguage)("\u5e93\u5b58")),dataIndex:"goodsStock",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("goodsStock",{initialValue:e,rules:[{required:!0,message:"".concat((0,P.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))}]})(E.default.createElement(u.default,{min:0,max:99999999,precision:0,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e,"goodsStock",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u91cd\u91cf(KG)")),dataIndex:"weight",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("weight",{initialValue:e||1})(E.default.createElement(u.default,{min:.001,max:999999.999,precision:3,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e,"weight",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u957f(CM)")),dataIndex:"length",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("length",{initialValue:e||1})(E.default.createElement(u.default,{min:.001,max:999999.999,precision:3,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e,"length",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u5bbd(CM)")),dataIndex:"width",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("width",{initialValue:e||1})(E.default.createElement(u.default,{min:.001,max:999999.999,precision:3,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e,"width",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u9ad8(CM)")),dataIndex:"height",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("height",{initialValue:e||1})(E.default.createElement(u.default,{min:.001,max:999999.999,precision:3,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e,"height",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u9884\u8b66\u503c")),dataIndex:"stockWarning",align:"center",width:100,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("stockWarning",{initialValue:e})(E.default.createElement(u.default,{min:0,max:300,precision:0,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e,"stockWarning",t.key)}})))}},{title:"".concat((0,P.sldComLanguage)("\u8d27\u53f7")),dataIndex:"productCode",align:"center",width:150,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("productCode",{initialValue:e})(E.default.createElement(c.default,{maxLength:20,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e.target.value,"productCode",t.key)}})))}},{title:E.default.createElement("div",{style:{position:"relative"}},(0,P.sldComLanguage)("\u6761\u5f62\u7801"),E.default.createElement(r.default,{placement:"bottomLeft",title:(0,P.sldComLanguage)("\u865a\u62df\u5546\u54c1\u65e0\u9700\u586b\u5199")},E.default.createElement("div",{style:{right:-15,top:2,position:"absolute"}},(0,P.sldSvgIcon)("#bfbbba",14,14,"wen")))),dataIndex:"barCode",align:"center",width:150,render:function(e,t){return E.default.createElement(q,{style:{width:"100%"}},n("barCode",{initialValue:e})(E.default.createElement(c.default,{maxLength:30,style:{width:"100%"},onChange:function(e){return a.handleFieldChangeSpu(e.target.value,"barCode",t.key)}})))}}],goods_video_data:[{type:"upload_video",label:"".concat((0,P.sldComLanguage)("\u5546\u54c1\u89c6\u9891")),name:"video",extra:"".concat((0,P.sldComLanguage)("\u6700\u5927\u9650\u5236")).concat(O.uploadLimit).concat((0,P.sldComLanguage)("M,\u652f\u6301mp4\u683c\u5f0f,\u63a8\u8350\u65f6\u957f\u4e0d\u4f4e\u4e8e6s,\u4e0d\u8d85\u8fc790s")),fileList:[],upload_name:"file",upload_url:O.apiUrl+"v3/oss/common/upload?source=video",initialValue:"",img_succ_info:{},item_height:140,uploadPreview:a.uploadImgPre,delVideo:a.delVideo,uploadChange:function(e){return a.uploadVideo(e,"video")}}],goods_img_data:[],spec_set_data:[{type:"goods_spec_sele_b2c",label:"".concat((0,P.sldComLanguage)("\u89c4\u683c\u9009\u62e9")),name:"goods_spec_sele",sel_data:[],show_data:[],disable:void 0!=e.location.query.id,addSpec:a.addSpec,addSpecValue:a.addSpecValue,handleSetOpenFlag:function(e){return a.handleSetOpenFlag(e)},handleSpecChange:function(e){return a.handleSpecChange(e)},handleSpecFocus:function(e){return a.handleSpecFocus(e)},setImgSpec:function(e,t){return a.setImgSpec(e,t)},is_add_spec:!1,handleSpecSele:a.handleSpecSele,handleDelAddSpec:a.handleDelAddSpec,handleEditAddSpec:a.handleEditAddSpec,uploadPreview:a.uploadImgPre,uploadChange:a.uploadImgSpec,upload_name:"file",upload_url:O.apiUrl+"v3/oss/common/upload?source=goods"}],spec_data_table:{list:[],pagination:{current:1,pageSize:2,total:0}},spu_data_table:{list:[{marketPrice:"",goodsPrice:"",goodsStock:"",weight:1,length:1,width:1,height:1,stockWarning:"",productCode:"",barCode:""}],pagination:{current:1,pageSize:2,total:0}},cur_goods_type:1,goods_base_data:[{type:"tree_select_more",label:"".concat((0,P.sldComLanguage)("\u79ef\u5206\u5546\u54c1\u6807\u7b7e")),name:"labelId",placeholder:"".concat((0,P.sldComLanguage)("\u8bf7\u9009\u62e9\u79ef\u5206\u5546\u54c1\u6807\u7b7e")),extra:"".concat((0,P.sldComLanguage)("\u5546\u54c1\u53ef\u4ee5\u4ece\u5c5e\u4e8e\u79ef\u5206\u5546\u57ce\u7684\u591a\u4e2a\u6807\u7b7e\u4e4b\u4e0b")),sel_data:[],required:!0,onChange:a.handleSelLabel,rules:[{required:!0,message:"".concat((0,P.sldComLanguage)("\u8bf7\u9009\u62e9\u79ef\u5206\u5546\u54c1\u6807\u7b7e"))}]},{type:"radio",label:"".concat((0,P.sldComLanguage)("\u5546\u54c1\u7c7b\u578b")),extra:"".concat((0,P.sldComLanguage)("\u7f16\u8f91\u5546\u54c1\u7684\u65f6\u5019\u65e0\u6cd5\u66f4\u6539\u5546\u54c1\u7c7b\u578b\uff0c\u8bf7\u8c28\u614e\u9009\u62e9")),name:"isVirtualGoods",placeholder:"",sel_data:[{name:"".concat((0,P.sldComLanguage)("\u5b9e\u7269\u5546\u54c1(\u9700\u8981\u7269\u6d41)")),key:1},{name:"".concat((0,P.sldComLanguage)("\u865a\u62df\u5546\u54c1(\u65e0\u9700\u7269\u6d41)")),key:2}],initialValue:1,onChange:a.handleGoodsType},{type:"input",label:"".concat((0,P.sldComLanguage)("\u79ef\u5206\u5546\u54c1\u540d\u79f0")),name:"goodsName",extra:"".concat((0,P.sldComLanguage)("\u6700\u591a\u8f93\u516550\u4e2a\u5b57")),placeholder:"".concat((0,P.sldComLanguage)("\u8bf7\u8f93\u5165\u79ef\u5206\u5546\u54c1\u540d\u79f0")),initialValue:"",required:!0,maxLength:50,rules:[{required:!0,whitespace:!0,message:"".concat((0,P.sldComLanguage)("\u8bf7\u8f93\u5165\u79ef\u5206\u5546\u54c1\u540d\u79f0"))}]},{type:"input",label:"".concat((0,P.sldComLanguage)("\u79ef\u5206\u5546\u54c1\u5e7f\u544a\u8bed")),name:"goodsBrief",placeholder:"".concat((0,P.sldComLanguage)("\u8bf7\u8f93\u5165\u79ef\u5206\u5546\u54c1\u5e7f\u544a\u8bed")),extra:"".concat((0,P.sldComLanguage)("\u6700\u591a\u8f93\u516550\u4e2a\u5b57")),initialValue:"",required:!0,maxLength:50,rules:[{required:!0,whitespace:!0,message:"".concat((0,P.sldComLanguage)("\u8bf7\u8f93\u5165\u79ef\u5206\u5546\u54c1\u5e7f\u544a\u8bed"))}]}],invoice_data:[{type:"radio",label:"".concat((0,P.sldComLanguage)("\u662f\u5426\u5f00\u4e13\u7968")),name:"isVatInvoice",placeholder:"",sel_data:[{name:"".concat((0,P.sldComLanguage)("\u662f")),key:1},{name:"".concat((0,P.sldComLanguage)("\u5426")),key:0}],initialValue:0}],other_data:[{type:"radio",label:"".concat((0,P.sldComLanguage)("\u53d1\u5e03\u72b6\u6001")),name:"sellNow",placeholder:"",width:250,sel_data:[{name:"".concat((0,P.sldComLanguage)("\u7acb\u5373\u552e\u5356")),key:!0},{name:"".concat((0,P.sldComLanguage)("\u6682\u4e0d\u552e\u5356\uff0c\u653e\u5165\u4ed3\u5e93\u4e2d")),key:!1}],initialValue:!0}]},a}return(0,I.default)(t,e),(0,h.default)(t,[{key:"componentDidMount",value:function(){var e=this.state.query;void 0==e.id&&this.setState({show_radio_flag:!0,initEditorFlag:!0}),this.setState({top_nav_step:1,step:1}),this.initSpuGoodsImgData(),this.getPointLabels(),this.get_spec_list(),this.resize(),window.addEventListener("resize",this.resize),this.props.dispatch({type:"global/getLayoutCollapsed"}),this.get_common_setting()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"resize",value:function(){var e=0,t=document.body.clientWidth,a=document.body.clientHeight;t>1649?e=a-73-50-310:t<=1649&&(e=a-73-50-350),A.setState({scrollY:e,screentW:t,screentH:a})}},{key:"handleFieldChange",value:function(e,t,a){var n=this.state.spec_data_table,i=n.list.filter(function(e){return e.key==a})[0];i&&(i[t]=e,this.setState({spec_data_table:n},function(){A.props.form.resetFields(["integralPrice".concat(a),"productPrice".concat(a)])}))}},{key:"handleFieldChangeDefault",value:function(e,t,a){var n=this,i=this.state.spec_data_table,l=i.list.filter(function(e){return e.key==a});l[0].isDefault=e,1==e&&i.list.map(function(e,t){e.key!=a?(n.props.form.resetFields(["isDefault"+e.key]),i.list[t].isDefault=0):i.list[t].state=1}),this.setState({spec_data_table:i})}},{key:"handleFieldChangeSpu",value:function(e,t,a){var n=this.state.spu_data_table;n.list[0][t]=e,this.setState({spu_data_table:n},function(){A.props.form.resetFields(["integralPrice","goodsPrice"])})}},{key:"render",value:function(){var e=this,t=this.state,a=t.goods_base_data,n=t.spec_data_table,i=t.columns_spec,d=t.query,o=t.preview_img,r=t.preview_alt_con,c=t.show_preview_modal,u=t.modal_width,p=t.initEditorFlag,g=t.goods_img_data,f=t.spec_set_data,m=t.other_data,h=t.top_nav_step,_=t.spu_data_table,v=t.columns_spu,y=t.pageLoading,I=t.invoice_data,L=t.convert_rate,C=t.goods_video_data,S=t.show_radio_flag,V=t.getEditorContentFlag,b=t.initEditorContent;return E.default.createElement("div",{className:"".concat(F.default.common_page," ").concat(F.default.com_flex_column),style:{position:"relative"}},E.default.createElement("div",{className:"".concat(F.default.flex_com_space_between," ").concat(F.default.add_goods_title)},(0,P.sldLlineRtextAddGoods)("#69A2F2",void 0!=d.id&&1*d.id>0?"".concat((0,P.sldComLanguage)("\u7f16\u8f91\u5546\u54c1")):"".concat((0,P.sldComLanguage)("\u53d1\u5e03\u5546\u54c1")))),E.default.createElement(l.default,{spinning:y},E.default.createElement("div",{className:"".concat(F.default.add_goods_top_nav," ").concat(F.default.flex_row_start_center)},E.default.createElement("div",{className:"".concat(F.default.top_nav_item," ").concat(F.default.step1," ").concat(F.default.right_row," ").concat(h>=1?F.default.finished:null),onClick:function(){return e.operateCurNavStep(1)}},E.default.createElement("div",{className:"".concat(F.default.step," ").concat(F.default.flex_row_start_center)},E.default.createElement("div",{className:"".concat(F.default.left," ").concat(F.default.flex_row_center_center)},"1"),E.default.createElement("div",{className:"".concat(F.default.right," ").concat(F.default.flex_column_center_start)},E.default.createElement("span",{className:"".concat(F.default.title)},(0,P.sldComLanguage)("\u57fa\u672c\u4fe1\u606f")),E.default.createElement("span",{className:"".concat(F.default.sub_title)},(0,P.sldComLanguage)("\u586b\u5199\u5546\u54c1\u57fa\u672c\u4fe1\u606f,\u53d1\u7968\u4fe1\u606f\u4ee5\u53ca\u5176\u4ed6\u4fe1\u606f"))))),E.default.createElement("div",{className:"".concat(F.default.top_nav_item," ").concat(F.default.left_row," ").concat(h>=2?F.default.finished:null),onClick:function(){return e.operateCurNavStep(2)}},E.default.createElement("div",{className:"".concat(F.default.step," ").concat(F.default.flex_row_start_center),style:{borderBottomLeftRadius:0,borderBottomRightRadius:3,borderTopLeftRadius:0,borderTopRightRadius:3}},E.default.createElement("div",{className:"".concat(F.default.left," ").concat(F.default.flex_row_center_center)},"2"),E.default.createElement("div",{className:"".concat(F.default.right," ").concat(F.default.flex_column_center_start)},E.default.createElement("span",{className:"".concat(F.default.title)},(0,P.sldComLanguage)("\u5546\u54c1\u8be6\u60c5")),E.default.createElement("span",{className:"".concat(F.default.sub_title)},(0,P.sldComLanguage)("\u8bbe\u7f6e\u89c4\u683c\u4fe1\u606f,\u4e0a\u4f20\u5546\u54c1\u56fe\u7247\u5e76\u5b8c\u5584\u5546\u54c1\u8be6\u60c5")))))),E.default.createElement(w.default,{onSubmit:function(t){return e.handleSaveAllData()},layout:"inline"},E.default.createElement(N.Scrollbars,{ref:"scrollbars",autoHeight:!0,autoHeightMin:100,autoHeightMax:document.body.clientHeight},E.default.createElement("div",{className:"".concat(F.default.goods_sku_tab," ").concat(F.default.add_goods_wrap)},E.default.createElement("div",{style:{display:1==h?"block":"none"}},E.default.createElement("div",null,(0,P.sldCommonTitleByBg)("".concat((0,P.sldComLanguage)("\u57fa\u672c\u4fe1\u606f"))),(0,P.getSldEmptyH)(10),S&&E.default.createElement(T.default,{part_width:100,lwidth:10,rwidth:90,form:this.props.form,data:a})),(0,P.getSldEmptyH)(10),(0,P.sldCommonTitleByBg)("".concat((0,P.sldComLanguage)("\u53d1\u7968\u4fe1\u606f"))),(0,P.getSldEmptyH)(10),E.default.createElement(T.default,{part_width:100,lwidth:10,rwidth:90,form:this.props.form,data:I}),(0,P.getSldEmptyH)(10),E.default.createElement("div",{ref:"other_info_position"},(0,P.sldCommonTitleByBg)("".concat((0,P.sldComLanguage)("\u5176\u4ed6\u4fe1\u606f")))),(0,P.getSldEmptyH)(10),E.default.createElement(T.default,{part_width:100,lwidth:10,rwidth:90,form:this.props.form,data:m}),(0,P.getSldEmptyH)(110)),E.default.createElement("div",{style:{display:2==h?"block":"none"}},E.default.createElement("div",null,(0,P.getSldEmptyH)(10),(0,P.sldCommonTitleByBg)("".concat((0,P.sldComLanguage)("\u4ef7\u683c\u5e93\u5b58"))),(0,P.getSldEmptyH)(10),E.default.createElement(D.default,{part_width:100,lwidth:10,rwidth:90,form:this.props.form,data:f})),(0,P.getSldEmptyH)(10),(0,P.showMoreHelpTip)("",["".concat((0,P.sldComLanguage)("\u79ef\u5206\u5151\u6362\u73b0\u91d1\u6bd4\u4f8b\u4e3a")).concat(L," \uff1a1\uff0c").concat((0,P.sldComLanguage)("\u5373")).concat(L).concat((0,P.sldComLanguage)("\u79ef\u5206")," = 1").concat((0,P.sldComLanguage)("\u5143"),"\u3002"),"".concat((0,P.sldComLanguage)("\u79ef\u5206\u548c\u73b0\u91d1\u81f3\u5c11\u8bbe\u7f6e\u4e00\u9879\u4e14\u9700\u5927\u4e8e0\uff0c\u8bbe\u7f6e\u79ef\u5206\u6570\u9700\u4e3a\u5e73\u53f0\u8bbe\u7f6e\u7684\u5151\u6362\u6bd4\u4f8b\u79ef\u5206"),"(").concat(L,")").concat((0,P.sldComLanguage)("\u7684\u6574\u6570\u500d\u3002")),"".concat((0,P.sldComLanguage)("\u4f1a\u5458\u5151\u6362\u65f6\uff0c\u53ef\u4ee5\u6839\u636e\u5e73\u53f0\u8bbe\u7f6e\u7684\u79ef\u5206\u4e0e\u73b0\u91d1\u5151\u6362\u6bd4\u4f8b\u81ea\u7531\u9009\u62e9\u4f7f\u7528\u79ef\u5206\u6570\u3002"))]),(0,P.getSldEmptyH)(10),void 0!=n.list&&n.list.length>0?E.default.createElement(E.Fragment,null,E.default.createElement("div",{className:F.default.add_goods_sku_list},E.default.createElement(s.default,{pagination:!1,columns:i,dataSource:n.list,scroll:{x:1500,y:300},size:"small"}))):E.default.createElement(E.Fragment,null,E.default.createElement("div",{className:F.default.add_goods_sku_list},E.default.createElement(s.default,{pagination:!1,columns:v,dataSource:_.list,scroll:{x:1500,y:300},size:"small"}))),E.default.createElement("div",null,(0,P.getSldEmptyH)(10),(0,P.sldCommonTitleByBg)("".concat((0,P.sldComLanguage)("\u5546\u54c1\u56fe\u7247"))),(0,P.getSldEmptyH)(10),E.default.createElement(T.default,{part_width:100,lwidth:10,rwidth:90,form:this.props.form,data:g})),E.default.createElement("div",null,(0,P.getSldEmptyH)(10),(0,P.sldCommonTitleByBg)("".concat((0,P.sldComLanguage)("\u5546\u54c1\u89c6\u9891"))),(0,P.getSldEmptyH)(10),E.default.createElement(T.default,{part_width:100,lwidth:10,rwidth:90,form:this.props.form,data:C})),E.default.createElement("div",null,(0,P.getSldEmptyH)(10),(0,P.sldCommonTitleByBg)("".concat((0,P.sldComLanguage)("\u5546\u54c1\u8be6\u60c5\u63cf\u8ff0"))),(0,P.getSldEmptyH)(10)),E.default.createElement("div",{style:{width:document.body.clientWidth-(this.props.global.collapsed?90:160)-35}},p&&E.default.createElement(J.default,{id:"agreement",getContentFlag:V,getEditorContent:this.getEditorContent,initEditorContent:b}),(0,P.getSldEmptyH)(10)),(0,P.getSldEmptyH)(110))),(0,P.getSldEmptyH)(130),E.default.createElement("div",{className:F.default.m_diy_bottom_wrap,style:{position:"fixed",left:this.props.global.collapsed?90:160}},E.default.createElement("div",{onClick:function(){return e.backPre()},className:F.default.add_goods_bottom_btn},(0,P.sldComLanguage)("\u8fd4\u56de")),E.default.createElement("div",{onClick:function(){return e.operateCurNavStep(1==h?2:1)},className:F.default.add_goods_bottom_btn},"".concat(1==h?(0,P.sldComLanguage)("\u4e0b\u4e00\u6b65"):(0,P.sldComLanguage)("\u4e0a\u4e00\u6b65"))),!(void 0!=d.id&&d.id>0)&&E.default.createElement("div",{onClick:function(){return e.handleSaveAllData()},className:"".concat(F.default.add_goods_bottom_btn," ").concat(F.default.add_goods_bottom_btn_sel)},(0,P.sldComLanguage)("\u53d1\u5e03")),void 0!=d.id&&d.id>0&&E.default.createElement("div",{onClick:function(){return e.handleSaveAllData()},className:"".concat(F.default.add_goods_bottom_btn," ").concat(F.default.add_goods_bottom_btn_sel)},(0,P.sldComLanguage)("\u4fdd\u5b58")))))),E.default.createElement(R.default,{img:o,show_preview_modal:c,modal_width:u,preview_alt_con:r,closePreviewModal:function(){return e.viewImg(!1)}}))}}]),t}(E.Component),S=V))||S)||S);t.default=H}}]);
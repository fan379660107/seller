(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[74],{"+5yv":function(t,e,a){"use strict";var o=a("g09b"),n=a("tAuX");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var l=o(a("2Taf")),i=o(a("vZ4D")),d=o(a("l4Ni")),r=o(a("ujKo")),s=o(a("rlhR")),u=o(a("MhPg"));a("y8nQ");var c,p,f,m,g=o(a("Vl3Y")),v=a("MuoO"),h=n(a("q1tI")),y=a("+n12"),_=o(a("hh8c")),E=o(a("3UVY")),C=o(a("BDXA")),b=a("k82f"),D=(c=(0,v.connect)(function(t){var e=t.product,a=t.global;return{product:e,global:a}}),p=g.default.create(),c(f=p((m=function(t){function e(t){var a;return(0,l.default)(this,e),a=(0,d.default)(this,(0,r.default)(e).call(this,t)),a.get_detail=function(){var t=a.props.dispatch,e=a.state,o=e.operate_data,n=e.query,l=e.positionData;t({type:"product/get_related_template_detail",payload:{templateId:n.id},callback:function(t){for(var e in o)o[e].initialValue=t.data[o[e].name];for(var n in l)l[n].initialValue=t.data[l[n].name];a.setState({operate_data:o,positionData:l,initEditorContent:(0,y.quillEscapeToHtml)(t.data.templateContent),flag:!0,initEditorFlag:!0})}})},a.changePosition=function(t){var e=a.state.positionData,o=e.filter(function(t){return"templatePosition"==t.name})[0];o.initialValue=t,a.setState({positionData:e})},a.handleSaveAllData=function(){a.setState({getEditorContentFlag:!0})},a.saveData=function(t){var e=(0,s.default)(a);a.props.form.validateFieldsAndScroll(function(o,n){if(!o){var l=a.props.dispatch;n.templateContent=t;var i=a.state.query;n.templateId=i.id;var d="";d=void 0!=i.id&&i.id>0?"product/edit_related_template":"product/add_related_template",l({type:d,payload:n,callback:function(t){200==t.state?((0,y.sucTip)(t.msg),e.props.history.goBack()):(0,y.failTip)(t.msg)}})}})},a.getEditorContent=function(t){a.saveData(t),a.setState({getEditorContentFlag:!1})},a.state={initEditorFlag:!1,getEditorContentFlag:!1,initEditorContent:"",flag:!1,template_con:"",query:t.location.query,operate_data:[{type:"input",label:"".concat((0,y.sldComLanguage)("\u7248\u5f0f\u540d\u79f0")),name:"templateName",placeholder:"".concat((0,y.sldComLanguage)("\u8bf7\u8f93\u5165\u7248\u5f0f\u540d\u79f0")),initialValue:"",maxLength:10,rules:[{required:!0,whitespace:!0,message:"".concat((0,y.sldComLanguage)("\u8bf7\u8f93\u5165\u7248\u5f0f\u540d\u79f0"))}]}],positionData:[{type:"radio",label:"".concat((0,y.sldComLanguage)("\u7248\u5f0f\u4f4d\u7f6e")),name:"templatePosition",placeholder:"",initialValue:1,sel_data:[{name:"\u9876\u90e8",key:1},{name:"\u5e95\u90e8",key:2}],onChange:a.changePosition}]},a}return(0,u.default)(e,t),(0,i.default)(e,[{key:"componentDidMount",value:function(){var t=this.state.query;this.props.dispatch({type:"global/getLayoutCollapsed"}),void 0!=t.id&&t.id>0?this.get_detail():this.setState({initEditorFlag:!0})}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var t=this,e=this.state,a=e.operate_data,o=e.positionData,n=e.query,l=e.flag,i=e.initEditorFlag,d=e.getEditorContentFlag,r=e.initEditorContent;return h.default.createElement("div",{className:_.default.common_page_20,style:{display:"flex",flexDirection:"column",justifyContent:"flex-start"}},(0,y.sldLlineRtextAddGoods)("#69A2F2","".concat((0,y.sldComLanguage)("\u57fa\u672c\u4fe1\u606f"))),h.default.createElement(b.Scrollbars,{autoHeight:!0,autoHeightMin:100,autoHeightMax:document.body.clientHeight-140},h.default.createElement("div",{className:_.default.tableListFormAdd},h.default.createElement("div",{style:{display:"flex",flexDirection:"column"}},h.default.createElement(g.default,{onSubmit:function(){return t.handleSaveAllData()},layout:"inline"},h.default.createElement(E.default,{form:this.props.form,search_data:a}),(0,y.getSldEmptyH)(10),(void 0==n.id||void 0!=n.id&&l)&&h.default.createElement(E.default,{form:this.props.form,search_data:o}),(0,y.getSldEmptyH)(15),(0,y.sldLlineRtextAddGoods)("#69A2F2","".concat((0,y.sldComLanguage)("\u5185\u5bb9\u7f16\u8f91"))),h.default.createElement("div",{className:_.default.goods_sku_tab,style:{marginTop:20,position:"relative"}},i&&h.default.createElement(C.default,{id:"agreement",getContentFlag:d,getEditorContent:this.getEditorContent,initEditorContent:r})),h.default.createElement("div",{className:_.default.m_diy_bottom_wrap,style:{position:"fixed",left:this.props.global.collapsed?90:160}},h.default.createElement("div",{onClick:function(){return t.props.history.goBack()},className:_.default.add_goods_bottom_btn},(0,y.sldComLanguage)("\u8fd4\u56de")),h.default.createElement("div",{onClick:function(){return t.handleSaveAllData()},className:"".concat(_.default.add_goods_bottom_btn," ").concat(_.default.add_goods_bottom_btn_sel)},(0,y.sldComLanguage)("\u4fdd\u5b58\u5e76\u8fd4\u56de"))))))))}}]),e}(h.Component),f=m))||f)||f);e.default=D}}]);
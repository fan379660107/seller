(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[108],{"8hCv":function(e,t,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var o=l(a("W9HT"));a("g9YV");var d=l(a("wCAj"));a("sRBo");var c=l(a("kaz8"));a("P2fV");var i=l(a("NJEC"));a("nRaC");var r=l(a("5RzL"));a("BoS7");var s=l(a("Sdc0"));a("5NDa");var u=l(a("5rEg"));a("giR+");var f=l(a("fyUT")),m=l(a("gWZ8")),g=l(a("p0pE")),h=l(a("2Taf")),p=l(a("vZ4D")),_=l(a("l4Ni")),C=l(a("ujKo")),v=l(a("rlhR")),w=l(a("MhPg"));a("OaEy");var y=l(a("2fM7"));a("y8nQ");var b=l(a("Vl3Y"));a("7Kak");var E,I,S,L,k=l(a("9yH6")),x=a("MuoO"),N=n(a("q1tI")),P=a("k82f"),R=a("+n12"),F=l(a("hh8c")),V=l(a("JMh9")),H=l(a("cgIu")),M="",W=k.default.Group,A=b.default.Item,B=(y.default.Option,E=(0,x.connect)(function(e){var t=e.point,a=e.global,l=e.common;return{point:t,global:a,common:l}}),I=b.default.create(),E(S=I((L=function(e){function t(e){var a;(0,h.default)(this,t),a=(0,_.default)(this,(0,C.default)(t).call(this,e)),a.point_label_lists=[],a.sel_label_data=[],a.sele_more_goods={info:[],ids:[],min_num:1},a.get_common_setting=function(){var e=a.props.dispatch;e({type:"common/getSetting",payload:{str:"integral_conversion_ratio"},callback:function(e){200==e.state&&a.setState({convert_rate:1*e.data[0].value})}})},a.validatorMarketPrice=function(e,t,a,l){t&&t<=l&&a("".concat((0,R.sldComLanguage)("\u5e94\u5927\u4e8e\u73b0\u91d1\u4ef7"))),a()},a.validatorIntegral=function(e,t,l){var n=a.state.convert_rate;t%n>0&&l("".concat((0,R.sldComLanguage)("\u9700\u4e3a")).concat(n).concat((0,R.sldComLanguage)("\u7684\u6574\u6570\u500d"))),l()},a.getPointLabels=function(){var e=a.props.dispatch,t=(a.state.goods_base_data,"point/get_point_label_list"),l={pageSize:R.list_com_page_more};e({type:t,payload:l,callback:function(e){if(200==e.state){for(var t in e.data.list)e.data.list[t].key=e.data.list[t].labelId,e.data.list[t].value=e.data.list[t].labelId,e.data.list[t].title=e.data.list[t].labelName,null!=e.data.list[t].children&&e.data.list[t].children.length>0?e.data.list[t].children.map(function(e){e.key=e.labelId,e.value=e.labelId,e.title=e.labelName}):e.data.list[t].disableCheckbox=!0;a.point_label_lists=e.data.list,a.setState({point_label_list:e.data.list})}}})},a.batchConfirm=function(e,t,l){var n=a.state,o=n.selectedRows,d=n.battchVal,c=[];for(var i in o)if(o[i].goodsId==l.goodsId){o[i].productList.map(function(e){e[t]=d,c.push(e.productId)});break}a.setState({selectedRows:o,battchVal:""},function(){c.map(function(e){M.props.form.resetFields(["integralPrice"+e,"cashPrice"+e,"productStock"+e,"productStockWarning"+e,"productCode"+e,"barCode"+e,"state"+e])})})},a.handleFieldBattchChange=function(e,t,l){a.setState({battchVal:e})},a.setAll=function(e,t){var l=a.state.selectedRows,n=[];for(var o in l)if(l[o].goodsId==t.goodsId){l[o].productList.map(function(t){n.push(t.productId),t.state=e.target.checked?1:0});break}a.setState({selectedRows:l},function(){n.map(function(e){M.props.form.resetFields(["state"+e])})})},a.handleSelectRows=function(e,t){a.setState({selectedRows:e,selectedRowKeys:t})},a.handleSaveAllData=function(){var e=a.props.dispatch,t=a.state.selectedRows;a.props.form.validateFieldsAndScroll(function(l,n){if(!l){var o=[];if(t.map(function(e){var t=[];e.productList.map(function(e){1==e.state&&t.push({productId:e.productId,barCode:e.barCode,cashPrice:e.cashPrice,integralPrice:e.integralPrice,marketPrice:e.productPrice,productCode:e.productCode,productStock:e.productStock,productStockWarning:e.productStockWarning})}),t.length>0&&o.push({goodsId:e.goodsId,productList:t,labelIds:a.sel_label_data.join(","),sellNow:n.sellNow})}),0==o.length)return(0,R.failTip)("".concat((0,R.sldComLanguage)("\u8bf7\u9009\u62e9\u8981\u53c2\u4e0e\u6d3b\u52a8\u7684\u5546\u54c1"))),!1;M.setState({loading:!0});var d="";d="point/import_mall_goods",e({type:d,payload:o,callback:function(e){M.setState({loading:!1}),200==e.state?((0,R.sucTip)(e.msg),setTimeout(function(){M.props.history.goBack()},500)):(0,R.failTip)(e.msg)}})}})},a.sldHandleCancle=function(){a.setState({modalVisibleGoods:!1})},a.seleGoods=function(e,t){var l=a.state,n=l.selectedRows,o=l.selectedRowKeys;e.map(function(e,t){e.productList.map(function(t){t.goodsId=e.goodsId,t.state=1})}),o.map(function(a){if(t.indexOf(a)>-1)for(var l=n.filter(function(e){return e.goodsId==a})[0],o=0;o<e.length;o++)if(e[o].goodsId==a){e[o]=(0,g.default)({},l);break}}),a.sele_more_goods.ids=(0,m.default)(t),a.sele_more_goods.info=JSON.parse(JSON.stringify(e)),a.setState({selectedRows:e,selectedRowKeys:t}),a.sldHandleCancle()},a.delSpu=function(e){var t=a.state,l=t.selectedRows,n=t.selectedRowKeys;l=l.filter(function(t){return t.goodsId!=e}),n=n.filter(function(t){return t!=e}),a.sele_more_goods.ids=(0,m.default)(n),a.sele_more_goods.info=JSON.parse(JSON.stringify(l)),a.setState({selectedRows:l,selectedRowKeys:n})},a.addGoods=function(){a.setState({modalVisibleGoods:!0})},a.handleSelLabel=function(e,t,l){var n=[];e.length>0&&void 0!=l.allCheckedNodes.length&&l.allCheckedNodes.length&&l.allCheckedNodes.map(function(e){if(void 0!=e.children&&e.children.length)e.children.map(function(e){var t=void 0!=e.node?e.node.key:e.key;n.push(t)});else{var t=void 0!=e.node?e.node.key:e.key;n.push(t)}}),a.sel_label_data=n},M=(0,v.default)(a);var l=e.form.getFieldDecorator;return a.state={convert_rate:0,battchVal:"",point_label_list:[],loading:!1,modalVisibleGoods:!1,query:e.location.query,selectedRows:[],selectedRowKeys:[],detail:{},columns_spec:[{title:" ",dataIndex:"key",align:"center",width:30,render:function(e,t,a){return a+1}},{title:"SKU\u89c4\u683c",dataIndex:"specValues",align:"center",width:100,render:function(e,t,a){return e||"".concat((0,R.sldComLanguage)("\u9ed8\u8ba4"))}},{title:N.default.createElement("div",{style:{position:"relative"}},N.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),(0,R.sldComLanguage)("\u5546\u54c1\u539f\u4ef7(\xa5)")),dataIndex:"productPrice",align:"center",width:100,render:function(e,t){return N.default.createElement(A,{style:{width:"100%"}},l("productPrice".concat(t.productId),{initialValue:e,rules:1==t.state?[{required:!0,message:"".concat((0,R.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))},{validator:function(e,a,l){return M.validatorMarketPrice(e,a,l,t.cashPrice)}}]:[]})(N.default.createElement(f.default,{min:.01,max:9999999,precision:2,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"productPrice",t)}})))}},{title:N.default.createElement("div",{style:{position:"relative"}},N.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),(0,R.sldComLanguage)("\u79ef\u5206")),dataIndex:"integralPrice",align:"center",width:100,render:function(e,t){return N.default.createElement(A,{style:{width:"100%"}},l("integralPrice".concat(t.productId),{initialValue:e,rules:void 0!=t.cashPrice&&t.cashPrice||1!=t.state?[{validator:function(e,t,a){return M.validatorIntegral(e,t,a)}}]:[{required:!0,message:"".concat((0,R.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))},{validator:function(e,t,a){return M.validatorIntegral(e,t,a)}}]})(N.default.createElement(f.default,{min:void 0!=t.cashPrice&&t.cashPrice?0:1,max:99999999,precision:0,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"integralPrice",t)}})))}},{title:N.default.createElement("div",{style:{position:"relative"}},N.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),(0,R.sldComLanguage)("\u73b0\u91d1(\xa5)")),dataIndex:"cashPrice",align:"center",width:100,render:function(e,t){return N.default.createElement(A,{style:{width:"100%"}},l("cashPrice".concat(t.productId),{initialValue:e,rules:t.integralPrice||1!=t.state?[]:[{required:!0,message:"".concat((0,R.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))}]})(N.default.createElement(f.default,{min:t.integralPrice?0:.01,max:9999999,precision:2,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"cashPrice",t)}})))}},{title:N.default.createElement("div",{style:{position:"relative"}},N.default.createElement("span",{style:{color:"#FF2929",fontSize:13}},"*"),(0,R.sldComLanguage)("\u5e93\u5b58")),dataIndex:"productStock",align:"center",width:100,render:function(e,t){return N.default.createElement(A,{style:{width:"100%"}},l("productStock".concat(t.productId),{initialValue:e,rules:[{required:!0,message:"".concat((0,R.sldComLanguage)("\u8be5\u9879\u5fc5\u586b"))}]})(N.default.createElement(f.default,{min:1,max:99999999,precision:0,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"productStock",t)}})))}},{title:"".concat((0,R.sldComLanguage)("\u91cd\u91cf(KG)")),dataIndex:"weight",align:"center",width:100},{title:"".concat((0,R.sldComLanguage)("\u957f(CM)")),dataIndex:"length",align:"center",width:100},{title:"".concat((0,R.sldComLanguage)("\u5bbd(CM)")),dataIndex:"width",align:"center",width:100},{title:"".concat((0,R.sldComLanguage)("\u9ad8(CM)")),dataIndex:"height",align:"center",width:100},{title:"".concat((0,R.sldComLanguage)("\u9884\u8b66\u503c")),dataIndex:"productStockWarning",align:"center",width:100,render:function(e,t){return N.default.createElement(A,{style:{width:"100%"}},l("productStockWarning".concat(t.productId),{initialValue:e})(N.default.createElement(f.default,{min:0,max:300,precision:0,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e,"productStockWarning",t)}})))}},{title:"".concat((0,R.sldComLanguage)("\u8d27\u53f7")),dataIndex:"productCode",align:"center",width:150,render:function(e,t){return N.default.createElement(A,{style:{width:"100%"}},l("productCode".concat(t.productId),{initialValue:e})(N.default.createElement(u.default,{maxLength:20,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e.target.value,"productCode",t)}})))}},{title:"".concat((0,R.sldComLanguage)("\u6761\u5f62\u7801")),dataIndex:"barCode",align:"center",width:150,render:function(e,t){return N.default.createElement(A,{style:{width:"100%"}},l("barCode".concat(t.productId),{initialValue:e})(N.default.createElement(u.default,{maxLength:30,style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e.target.value,"barCode",t)}})))}},{title:"".concat((0,R.sldComLanguage)("\u53c2\u4e0e")),dataIndex:"state",align:"center",width:60,render:function(e,t){return N.default.createElement(A,{style:{width:"100%"}},l("state".concat(t.productId),{valuePropName:"checked",initialValue:1==e})(N.default.createElement(s.default,{style:{width:"100%"},onChange:function(e){return a.handleFieldChange(e?1:2,"state",t)}})))}}]},a}return(0,w.default)(t,e),(0,p.default)(t,[{key:"componentDidMount",value:function(){this.getPointLabels(),this.get_common_setting(),this.props.dispatch({type:"global/getLayoutCollapsed"})}},{key:"componentWillUnmount",value:function(){}},{key:"handleFieldChange",value:function(e,t,a){var l=this.state.selectedRows,n=l.filter(function(e){return e.goodsId==a.goodsId});if(n.length>0){var o=n[0].productList.filter(function(e){return e.productId==a.productId});o.length>0&&(o[0][t]=e,this.setState({selectedRows:l},function(){M.props.form.resetFields(["integralPrice"+a.productId,"cashPrice"+a.productId,"productStock"+a.productId,"productStockWarning"+a.productId,"productCode"+a.productId,"barCode"+a.productId,"state"+a.productId])}))}}},{key:"render",value:function(){var e=this,t=this.state,l=t.loading,n=t.modalVisibleGoods,s=t.point_label_list,u=t.columns_spec,m=t.selectedRows,g=t.battchVal,h=t.convert_rate,p=this.props.form.getFieldDecorator;return N.default.createElement("div",{className:"".concat(V.default.full_activity," ").concat(V.default.seckill," ").concat(F.default.common_page," ").concat(F.default.com_flex_column),style:{position:"relative"}},N.default.createElement(o.default,{spinning:l},N.default.createElement(P.Scrollbars,{autoHeight:!0,autoHeightMin:document.body.clientHeight-200,autoHeightMax:document.body.clientHeight-165},N.default.createElement(b.default,{layout:"inline"},N.default.createElement("div",{className:"".concat(F.default.goods_sku_tab," ").concat(F.default.add_goods_wrap)},N.default.createElement("div",null,(0,R.sldLlineRtextAddGoodsAddMargin)("#69A2F2","".concat((0,R.sldComLanguage)("\u5bfc\u5165\u5546\u57ce\u5546\u54c1")),0,0,10),(0,R.getSldHorLine)(1),(0,R.getSldEmptyH)(10),(0,R.showMoreHelpTip)("",["".concat((0,R.sldComLanguage)("\u79ef\u5206\u5151\u6362\u73b0\u91d1\u6bd4\u4f8b\u4e3a")).concat(h," \uff1a1\uff0c").concat((0,R.sldComLanguage)("\u5373")).concat(h).concat((0,R.sldComLanguage)("\u79ef\u5206")," = 1").concat((0,R.sldComLanguage)("\u5143\u3002")),"".concat((0,R.sldComLanguage)("\u79ef\u5206\u548c\u73b0\u91d1\u81f3\u5c11\u8bbe\u7f6e\u4e00\u9879\u4e14\u9700\u5927\u4e8e0\uff0c\u8bbe\u7f6e\u79ef\u5206\u6570\u9700\u4e3a\u5e73\u53f0\u8bbe\u7f6e\u7684\u5151\u6362\u6bd4\u4f8b\u79ef\u5206"),"(").concat(h,")").concat((0,R.sldComLanguage)("\u7684\u6574\u6570\u500d\u3002")),"".concat((0,R.sldComLanguage)("\u4f1a\u5458\u5151\u6362\u65f6\uff0c\u53ef\u4ee5\u6839\u636e\u5e73\u53f0\u8bbe\u7f6e\u7684\u79ef\u5206\u4e0e\u73b0\u91d1\u5151\u6362\u6bd4\u4f8b\u81ea\u7531\u9009\u62e9\u4f7f\u7528\u79ef\u5206\u6570\u3002"))]),(0,R.getSldEmptyH)(10),(0,R.sldCommonTitleByBg)("".concat((0,R.sldComLanguage)("\u57fa\u672c\u4fe1\u606f"))),N.default.createElement("div",{className:"".concat(V.default.full_acm_activity," ").concat(F.default.flex_column_start_start)},N.default.createElement("div",{className:"".concat(V.default.item," ").concat(F.default.flex_row_start_start)},N.default.createElement("div",{className:"".concat(V.default.left)},N.default.createElement("span",{style:{color:"red"}},"*"),(0,R.sldComLanguage)("\u5546\u54c1\u53d1\u5e03")),N.default.createElement("div",{className:"".concat(V.default.right)},N.default.createElement(A,null,p("sellNow",{initialValue:!0})(N.default.createElement(W,{size:"small"},N.default.createElement(k.default,{value:!0},(0,R.sldComLanguage)("\u7acb\u5373\u552e\u5356")),N.default.createElement(k.default,{value:!1},(0,R.sldComLanguage)("\u6682\u4e0d\u552e\u5356\uff0c\u653e\u5165\u4ed3\u5e93\u4e2d"))))))),N.default.createElement("div",{className:"".concat(V.default.item," ").concat(F.default.flex_row_start_start)},N.default.createElement("div",{className:"".concat(V.default.left)},N.default.createElement("span",{style:{color:"red"}},"*"),(0,R.sldComLanguage)("\u79ef\u5206\u5546\u54c1\u6807\u7b7e")),N.default.createElement("div",{className:"".concat(V.default.right)},N.default.createElement(A,null,p("labelId",{rules:[{required:!0,message:"".concat((0,R.sldComLanguage)("\u8bf7\u9009\u62e9\u79ef\u5206\u5546\u54c1\u6807\u7b7e"))}]})(N.default.createElement(r.default,{style:{width:250},treeData:s,treeCheckable:!0,treeDefaultExpandAll:!0,showCheckedStrategy:"SHOW_PARENT",placeholder:"".concat((0,R.sldComLanguage)("\u8bf7\u9009\u62e9\u79ef\u5206\u5546\u54c1\u6807\u7b7e")),allowClear:!0,onChange:this.handleSelLabel,dropdownStyle:{maxHeight:300},getPopupContainer:function(e){return e.parentNode}}))))))),(0,R.getSldEmptyH)(10),N.default.createElement("div",{className:"".concat(F.default.flex_row_start_center," ").concat(V.default.add_new)},(0,R.sldIconBtn)(function(){return e.addGoods()},"".concat((0,R.sldComLanguage)("\u6dfb\u52a0\u5546\u57ce\u5546\u54c1")),7,7),N.default.createElement("span",{className:"".concat(V.default.add_new_tip)},(0,R.sldComLanguage)("\u63d0\u9192\uff1a\u81f3\u5c11\u6dfb\u52a0\u4e00\u4e2a\u5546\u54c1"))),m.map(function(t,l){return N.default.createElement("div",{key:l,className:"".concat(V.default.sele_goods)},N.default.createElement("img",{onClick:function(){return e.delSpu(t.goodsId)},className:V.default.del_spu,src:a("deTX")}),N.default.createElement("div",{className:"".concat(V.default.goods_info," ").concat(F.default.flex_row_between_start)},N.default.createElement("div",{className:"".concat(V.default.goods_info_left," ").concat(F.default.flex_row_start_start)},N.default.createElement("div",{className:"".concat(V.default.goods_img_wrap," ").concat(F.default.flex_row_center_center)},N.default.createElement("img",{className:"".concat(V.default.goods_img),src:t.mainImage})),N.default.createElement("p",{className:"".concat(V.default.goods_name)},t.goodsName)),N.default.createElement("div",{className:"".concat(V.default.goods_info_right," ").concat(F.default.flex_row_end_end)},N.default.createElement(i.default,{title:N.default.createElement(f.default,{min:1,max:99999999,precision:0,style:{width:"100%"},value:g,onChange:function(a){return e.handleFieldBattchChange(a,"integralPrice",t)}}),onConfirm:function(a){e.batchConfirm(a,"integralPrice",t)}},N.default.createElement("div",{className:"".concat(V.default.batch_btn," ").concat(F.default.flex_row_center_center)},(0,R.sldComLanguage)("\u4fee\u6539\u79ef\u5206"))),N.default.createElement(i.default,{title:N.default.createElement(f.default,{min:.01,max:9999999,precision:2,style:{width:"100%"},value:g,onChange:function(a){return e.handleFieldBattchChange(a,"cashPrice",t)}}),onConfirm:function(a){e.batchConfirm(a,"cashPrice",t)}},N.default.createElement("div",{className:"".concat(V.default.batch_btn," ").concat(F.default.flex_row_center_center)},(0,R.sldComLanguage)("\u4fee\u6539\u73b0\u91d1"))),N.default.createElement(i.default,{title:N.default.createElement(f.default,{min:1,max:99999999,precision:0,style:{width:"100%"},value:g,onChange:function(a){return e.handleFieldBattchChange(a,"productStock",t)}}),onConfirm:function(a){e.batchConfirm(a,"productStock",t)}},N.default.createElement("div",{className:"".concat(V.default.batch_btn," ").concat(F.default.flex_row_center_center)},(0,R.sldComLanguage)("\u4fee\u6539\u5e93\u5b58"))),N.default.createElement(i.default,{title:N.default.createElement(f.default,{min:0,max:99999999,precision:0,style:{width:"100%"},value:g,onChange:function(a){return e.handleFieldBattchChange(a,"productStockWarning",t)}}),onConfirm:function(a){e.batchConfirm(a,"productStockWarning",t)}},N.default.createElement("div",{className:"".concat(V.default.batch_btn," ").concat(F.default.flex_row_center_center)},(0,R.sldComLanguage)("\u4fee\u6539\u9884\u8b66\u503c"))),N.default.createElement("div",{className:"".concat(V.default.batch_btn," ").concat(F.default.flex_row_center_center)},N.default.createElement(c.default,{onChange:function(a){e.setAll(a,t)}},N.default.createElement("span",{className:"".concat(V.default.sel_all)},(0,R.sldComLanguage)("\u5168\u90e8\u53c2\u4e0e")))))),N.default.createElement("div",{className:F.default.add_goods_sku_list},N.default.createElement(d.default,{rowKey:"productId",pagination:!1,columns:u,dataSource:t.productList,scroll:{x:1700,y:300},size:"small"})))})),N.default.createElement("div",{className:F.default.m_diy_bottom_wrap,style:{position:"fixed",left:this.props.global.collapsed?90:160}},N.default.createElement("div",{onClick:function(){return e.props.history.goBack()},className:F.default.add_goods_bottom_btn},(0,R.sldComLanguage)("\u8fd4\u56de")),N.default.createElement("div",{onClick:function(){return e.props.form.submit(e.handleSaveAllData)},className:"".concat(F.default.add_goods_bottom_btn," ").concat(F.default.add_goods_bottom_btn_sel)},(0,R.sldComLanguage)("\u4fdd\u5b58")))))),N.default.createElement(H.default,{selectedRows:this.sele_more_goods.info,selectedRowKeys:this.sele_more_goods.ids,modalVisible:n,width:1e3,height:document.body.clientHeight-400,sldHandleSeleMoreModalCancle:this.sldHandleCancle,seleSvideo:this.seleGoods,title:"".concat((0,R.sldComLanguage)("\u8bf7\u9009\u62e9\u5546\u54c1(\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a)")),extra:this.sele_more_goods}))}}]),t}(N.Component),S=L))||S)||S);t.default=B}}]);
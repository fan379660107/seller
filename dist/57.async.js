(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[57],{Cu8J:function(t,e,a){t.exports={detail_total_part:"antd-pro\\pages\\point\\bill\\bill-detail_total_part",amount_detail:"antd-pro\\pages\\point\\bill\\bill-amount_detail",amount_total:"antd-pro\\pages\\point\\bill\\bill-amount_total",invoice_btn:"antd-pro\\pages\\point\\bill\\bill-invoice_btn",progress:"antd-pro\\pages\\point\\bill\\bill-progress",item:"antd-pro\\pages\\point\\bill\\bill-item",top:"antd-pro\\pages\\point\\bill\\bill-top",left_line:"antd-pro\\pages\\point\\bill\\bill-left_line",right_line:"antd-pro\\pages\\point\\bill\\bill-right_line",state:"antd-pro\\pages\\point\\bill\\bill-state",time:"antd-pro\\pages\\point\\bill\\bill-time",cur:"antd-pro\\pages\\point\\bill\\bill-cur",no:"antd-pro\\pages\\point\\bill\\bill-no",pass:"antd-pro\\pages\\point\\bill\\bill-pass",state_part:"antd-pro\\pages\\point\\bill\\bill-state_part",title:"antd-pro\\pages\\point\\bill\\bill-title",tip:"antd-pro\\pages\\point\\bill\\bill-tip",agree_btn:"antd-pro\\pages\\point\\bill\\bill-agree_btn"}},UIKx:function(t,e,a){"use strict";var l=a("g09b"),n=a("tAuX");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=l(a("d6i3")),i=l(a("1l/V")),c=l(a("2Taf")),s=l(a("vZ4D")),d=l(a("l4Ni")),r=l(a("ujKo")),u=l(a("rlhR")),m=l(a("MhPg"));a("y8nQ");var g=l(a("Vl3Y"));a("2qtc");var p,_,f,b,h=l(a("kLXV")),w=a("MuoO"),C=n(a("q1tI")),v=a("+n12"),x=l(a("hh8c")),L=l(a("Cu8J")),y=l(a("nVqQ")),E=a("k82f"),N=l(a("CkN6")),k=l(a("fjb3")),T=l(a("mOP9")),I=l(a("usdK")),S=h.default.confirm,q=v.list_com_page_size_10,A=(p=(0,w.connect)(function(t){var e=t.point;return{point:e}}),_=g.default.create(),p(f=_((b=function(t){function e(t){var a;return(0,c.default)(this,e),a=(0,d.default)(this,(0,r.default)(e).call(this,t)),a.columns_order=[{title:" ",dataIndex:"bindId",align:"center",width:30,render:function(t,e,l){return(0,v.getTableNum)(a.state.params,q,l)}},{title:"".concat((0,v.sldComLanguage)("\u8ba2\u5355\u53f7")),dataIndex:"orderSn",align:"center",width:120},{title:"".concat((0,v.sldComLanguage)("\u4f7f\u7528\u79ef\u5206")),dataIndex:"integral",align:"center",width:100},{title:"".concat((0,v.sldComLanguage)("\u79ef\u5206\u62b5\u6263\u91d1\u989d(\u5143)")),dataIndex:"integralCashAmount",align:"center",width:100},{title:"".concat((0,v.sldComLanguage)("\u652f\u4ed8\u73b0\u91d1(\u5143)")),dataIndex:"cashAmount",align:"center",width:100},{title:"".concat((0,v.sldComLanguage)("\u5151\u6362\u65e5\u671f")),dataIndex:"createTime",align:"center",width:120},{title:"".concat((0,v.sldComLanguage)("\u5b8c\u6210\u65e5\u671f")),dataIndex:"finishTime",align:"center",width:120},{title:"".concat((0,v.sldComLanguage)("\u64cd\u4f5c")),align:"center",width:100,render:function(t,e){return C.default.createElement(T.default,{to:{pathname:"/point/order_list_to_detail",query:{orderSn:e.orderSn}}},(0,v.sldtbaleOpeBtnText)("".concat((0,v.sldComLanguage)("\u67e5\u770b")),function(){return null}))}}],a.get_bill_detail=function(t){var e=a.props.dispatch,l=a.state,n=l.bill_base_data,c=l.bill_detail_data,s=l.bill_progress_data,d=l.bill_settle_img;e({type:"point/get_bill_detail",payload:{billId:t},callback:function(){var t=(0,i.default)(o.default.mark(function t(e){var l,i;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(200==e.state){for(l in c=e.data,n)"startTime"==n[l].name?n[l].text=c.startTime+" ~ "+c.endTime:n[l].text=c[n[l].name];for(i in d.map(function(t){"paymentEvidence"==t.name?t.data=[{imageUrl:c[t.name]}]:t.text=c[t.name]}),s)i<c.logList.length&&(s[i].time=c.logList[i].createTime),c.state<s[i].state_code?s[i].cur_state="no":c.state==s[i].state_code?s[i].cur_state="cur":s[i].cur_state="pass";a.setState({loading:!1,bill_base_data:n,bill_detail_data:c,bill_progress_data:s,bill_settle_img:d})}case 1:case"end":return t.stop()}},t)}));function e(e){return t.apply(this,arguments)}return e}()})},a.viewImg=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";a.setState({preview_img:e,show_preview_modal:t})},a.checkConfirm=function(){var t=a.props.dispatch,e=a.state.query;t({type:"point/confirm_bill",payload:{billId:e.id},callback:function(){var t=(0,i.default)(o.default.mark(function t(l){return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:200==l.state?((0,v.sucTip)(l.msg),a.get_bill_detail(e.id)):255==l.state?(0,v.failTip)(l.msg):267==l.state&&S({style:{padding:24,background:"#fff",borderRadius:5},title:"".concat((0,v.sldComLanguage)("\u6e29\u99a8\u63d0\u793a")),content:l.msg,okText:"".concat((0,v.sldComLanguage)("\u786e\u5b9a")),okType:"primary",cancelText:"".concat((0,v.sldComLanguage)("\u53d6\u6d88")),onOk:function(){I.default.push("/bill/account")},onCancel:function(){}});case 1:case"end":return t.stop()}},t)}));function l(e){return t.apply(this,arguments)}return l}()})},(0,u.default)(a),a.state={preview_img:"",show_preview_modal:!1,modal_width:500,show_foot:!0,title:"",submiting:!1,modalVisible:!1,query:t.location.query,params:{pageSize:q},bill_base_data:[{type:"show_text",label:"".concat((0,v.sldComLanguage)("\u7ed3\u7b97\u5355\u53f7")),name:"billSn",extra:"",item_height:42,text:""},{type:"show_text",label:"".concat((0,v.sldComLanguage)("\u7ed3\u7b97\u8d77\u6b62\u65f6\u95f4")),name:"startTime",extra:"",item_height:42,text:""},{type:"show_text",label:"".concat((0,v.sldComLanguage)("\u5e97\u94fa\u540d\u79f0")),name:"storeName",extra:"",item_height:42,text:""},{type:"show_text",label:"".concat((0,v.sldComLanguage)("\u5e97\u94fa\u8054\u7cfb\u4eba")),name:"contactName",extra:"",item_height:42,text:""},{type:"show_text",label:"".concat((0,v.sldComLanguage)("\u5e97\u94fa\u8054\u7cfb\u7535\u8bdd")),name:"contactPhone",extra:"",item_height:42,text:""}],bill_detail_data:{},operateData:[],bill_progress_data:[{code:"createBill",state:"".concat((0,v.sldComLanguage)("\u751f\u6210\u7ed3\u7b97\u5355")),time:"",state_code:1,cur_state:"cur"},{code:"storeConfirm",state:"".concat((0,v.sldComLanguage)("\u5e97\u94fa\u786e\u8ba4")),time:"",state_code:2,cur_state:"no"},{code:"systemCheck",state:"".concat((0,v.sldComLanguage)("\u5e73\u53f0\u5ba1\u6838")),time:"",state_code:3,cur_state:"no"},{code:"finish",state:"".concat((0,v.sldComLanguage)("\u7ed3\u7b97\u5b8c\u6210")),time:"",state_code:4,cur_state:"no"}],bill_settle_img:[{type:"show_text",label:"".concat((0,v.sldComLanguage)("\u6253\u6b3e\u5907\u6ce8")),name:"paymentRemark",extra:"",item_height:42,text:""},{type:"show_goods_img_more",label:"".concat((0,v.sldComLanguage)("\u7ed3\u7b97\u51ed\u8bc1")),name:"paymentEvidence",initialValue:"",data:[],item_height:142,preView:a.viewImg}]},a}return(0,m.default)(e,t),(0,s.default)(e,[{key:"componentDidMount",value:function(){var t=this.state.query;this.get_bill_detail(t.id)}},{key:"render",value:function(){var t=this,e=this.state,l=e.bill_base_data,n=e.bill_detail_data,o=e.bill_progress_data,i=e.bill_settle_img,c=e.preview_img,s=e.show_preview_modal;return C.default.createElement("div",{className:x.default.common_page,style:{flex:1}},C.default.createElement("div",{className:x.default.flex_com_space_between,style:{margin:10,marginTop:0}},(0,v.sldLlineRtextAddGoods)("#69A2F2","".concat((0,v.sldComLanguage)("\u7ed3\u7b97\u8be6\u60c5"))),(0,v.sldIconBtnBg)(function(){t.props.history.goBack()},"fanhui","".concat((0,v.sldComLanguage)("\u8fd4\u56de\u4e0a\u7ea7\u9875\u9762")),"#fff",7,0,15,15,5)),(0,v.getSldHorLine)(1),C.default.createElement(E.Scrollbars,{autoHeight:!0,autoHeightMin:100,autoHeightMax:document.body.clientHeight-100},C.default.createElement("div",{className:"".concat(x.default.flex_row_center_start," ").concat(L.default.progress)},o.map(function(t,e){return C.default.createElement("div",{key:e,className:"".concat(x.default.flex_column_start_center," ").concat(L.default.item)},C.default.createElement("div",{className:"".concat(L.default.top," ").concat(x.default.flex_row_center_center)},C.default.createElement("span",{className:"".concat(L.default.left_line)}),C.default.createElement("img",{src:a("p2/J")("./".concat(e+1,"_").concat(t.cur_state,".png"))}),C.default.createElement("span",{className:"".concat(L.default.right_line)})),C.default.createElement("span",{className:"".concat(L.default.state)},t.state),C.default.createElement("span",{className:"".concat(L.default.time)},t.time))})),1==n.state&&C.default.createElement("div",{className:"".concat(L.default.state_part," ").concat(x.default.flex_column_start_center)},C.default.createElement("span",{className:L.default.title},(0,v.sldComLanguage)("\u7b49\u5f85\u5e97\u94fa\u786e\u8ba4")),(0,v.sldPopConfirmDiy)("leftBottom","".concat((0,v.sldComLanguage)("\u6211\u5df2\u786e\u8ba4\u6838\u5bf9\u8be5\u8d26\u5355\uff0c\u786e\u8ba4\u65e0\u8bef")),function(){return t.checkConfirm()},"".concat((0,v.sldComLanguage)("\u786e\u5b9a")),"".concat((0,v.sldComLanguage)("\u53d6\u6d88")),C.default.createElement("div",{className:L.default.invoice_btn},(0,v.sldComLanguage)("\u786e\u8ba4\u7ed3\u7b97\u5355")))),2==n.state&&C.default.createElement("div",{className:"".concat(L.default.state_part," ").concat(x.default.flex_column_start_center)},C.default.createElement("span",{className:L.default.title},(0,v.sldComLanguage)("\u7b49\u5f85\u5e73\u53f0\u5ba1\u6838"))),3==n.state&&C.default.createElement("div",{className:"".concat(L.default.state_part," ").concat(x.default.flex_column_start_center)},C.default.createElement("span",{className:L.default.title},(0,v.sldComLanguage)("\u7b49\u5f85\u5e73\u53f0\u7ed3\u7b97"))),4==n.state&&C.default.createElement("div",{className:"".concat(L.default.state_part," ").concat(x.default.flex_column_start_center)},C.default.createElement("span",{className:L.default.title},(0,v.sldComLanguage)("\u7ed3\u7b97\u5b8c\u6210"))),(0,v.sldCommonTitle)("".concat((0,v.sldComLanguage)("\u7ed3\u7b97\u4fe1\u606f")),"#333",5,15,15),C.default.createElement("div",{className:"".concat(L.default.detail_total_part," ").concat(x.default.flex_row_start_center)},C.default.createElement("img",{src:a("EE2V")}),C.default.createElement("span",{className:L.default.amount_total},"\xa0",(0,v.sldComLanguage)("\u7ed3\u7b97\u91d1\u989d\uffe5"),n.settleAmount," = \xa0"),C.default.createElement("span",{className:L.default.amount_detail}," ",(0,v.sldComLanguage)("\u73b0\u91d1\u4f7f\u7528\u91d1\u989d\uffe5"),n.cashAmount," + ",(0,v.sldComLanguage)("\u79ef\u5206\u62b5\u6263\u91d1\u989d\uffe5"),n.integralCashAmount)),(0,v.sldCommonTitle)("".concat((0,v.sldComLanguage)("\u7ed3\u7b97\u4fe1\u606f")),"#333",5,15,15),C.default.createElement(y.default,{r_color:"#333",l_color:"#999",l_fontw:500,r_fontw:600,form:this.props.form,data:l}),4==n.state&&C.default.createElement(C.Fragment,null,(0,v.sldCommonTitle)("".concat((0,v.sldComLanguage)("\u7ed3\u7b97\u51ed\u8bc1")),"#333",5,15,15),C.default.createElement(y.default,{part_width:100,lwidth:10,rwidth:90,form:this.props.form,data:i})),(0,v.sldCommonTitle)("".concat((0,v.sldComLanguage)("\u7ed3\u7b97\u8ba2\u5355\u4fe1\u606f")),"#333",5,15,15),C.default.createElement(N.default,{selectedRows:[],data:{list:n.orderList,pagination:{}},size:"small",rowKey:"orderSn",isCheck:!1,columns:this.columns_order,sldpagination:!1}),(0,v.getSldEmptyH)(40)),C.default.createElement(k.default,{img:c,show_preview_modal:s,modal_width:500,preview_alt_con:"".concat((0,v.sldComLanguage)("\u5546\u54c1\u56fe\u7247")),closePreviewModal:function(){return t.viewImg(!1)}}))}}]),e}(C.Component),f=b))||f)||f);e.default=A}}]);
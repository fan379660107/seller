(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[59],{l9Ub:function(e,t,a){e.exports={title:"antd-pro\\pages\\settled-manage\\business-info\\index-title",third_party:"antd-pro\\pages\\settled-manage\\business-info\\index-third_party",content:"antd-pro\\pages\\settled-manage\\business-info\\index-content",commen_wrap:"antd-pro\\pages\\settled-manage\\business-info\\index-commen_wrap",commen_title:"antd-pro\\pages\\settled-manage\\business-info\\index-commen_title",next_step:"antd-pro\\pages\\settled-manage\\business-info\\index-next_step"}},rnm7:function(e,t,a){"use strict";var n=a("g09b"),o=a("tAuX");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("+L6B");var s=n(a("2/Rp"));a("miYZ");var d=n(a("tsqr")),c=n(a("p0pE")),l=n(a("d6i3")),r=n(a("1l/V")),i=n(a("2Taf")),u=n(a("vZ4D")),p=n(a("l4Ni")),m=n(a("ujKo")),g=n(a("MhPg"));a("y8nQ");var f,_,h,y,C=n(a("Vl3Y")),w=a("MuoO"),v=o(a("q1tI")),b=a("+n12"),S=n(a("l9Ub")),x=n(a("nBFA")),k=a("k82f"),I=(f=(0,w.connect)(function(e){var t=e.settled,a=e.project;return{settled:t,project:a}}),_=C.default.create(),f(h=_((y=function(e){function t(e){var a;return(0,i.default)(this,t),a=(0,p.default)(this,(0,m.default)(t).call(this,e)),a.store_grade_column=[{title:"".concat((0,b.sldComLanguage)("\u5e97\u94fa\u7b49\u7ea7")),dataIndex:"gradeName",align:"center",width:100},{title:"".concat((0,b.sldComLanguage)("\u53ef\u53d1\u5e03\u5546\u54c1")),dataIndex:"goodsLimit",align:"center",width:100},{title:"".concat((0,b.sldComLanguage)("\u53ef\u63a8\u8350\u5546\u54c1")),dataIndex:"recommendLimit",align:"center",width:100},{title:"".concat((0,b.sldComLanguage)("\u6536\u8d39\u6807\u51c6")),dataIndex:"price",align:"center",width:100},{title:"".concat((0,b.sldComLanguage)("\u7533\u8bf7\u8bf4\u660e")),dataIndex:"description",align:"center",width:200}],a.select_cat_id=[],a.selectedRows=[],a.selectedRowKeys=[],a.handleCatCheck=function(e,t){var n=a.state.select_cat;a.select_cat_id=[],t.checkedNodes.length>0&&t.checkedNodes.map(function(e){if(3==e.props.grade){var t=e.props.path.split("/");a.select_cat_id.push("".concat(t[1],"-").concat(t[2],"-").concat(e.props.categoryId))}}),n[0].selected_keys=e,a.setState({select_cat:n})},a.handleSelectGrade=function(e,t){var n=a.state.store_grade_data;n[0].selectedRows=e,n[0].selectedRowKeys=t,a.setState({selectedRows:e,selectedRowKeys:t,store_grade_data:n})},a.getStoreGrade=function(){var e=a.state.store_grade_data,t=a.props.dispatch;t({type:"settled/get_store_grade",payload:{pageSize:b.list_com_page_more},callback:function(t){200==t.state&&(e[0].data=t.data.list,a.setState({store_grade_data:e}))}})},a.getStoreOpenTime=function(){var e=a.state.open_time_data,t=a.props.dispatch;t({type:"settled/get_store_open_time",callback:function(t){if(200==t.state){var n=[];t.data.map(function(e){n.push({key:e,name:e+"\u5e74"})}),e[0].sel_data=n,a.setState({open_time_data:e})}}})},a.getSystemCat=(0,r.default)(l.default.mark(function e(){var t,n;return l.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.select_cat,n=a.props.dispatch,e.next=4,n({type:"project/get_system_cat_tree_grade3",callback:function(e){200==e.state&&(e.data.length>0&&e.data.map(function(e){e.key=e.categoryId,e.title=e.categoryName,null!=e.children&&e.children.length>0?e.children.map(function(e){e.key=e.categoryId,e.title=e.categoryName,null!=e.children&&e.children.length>0?e.children.map(function(e){e.key=e.categoryId,e.title=e.categoryName}):e.disableCheckbox=!0}):e.disableCheckbox=!0}),t[0].tree_data=e.data),a.setState({select_cat:t})}});case 4:case"end":return e.stop()}},e)})),a.initData=function(){var e=(0,b.getSettleData)("bussinessInfo"),t=a.state,n=t.base_info,o=t.store_grade_data,s=t.open_time_data,d=t.select_cat;e&&(n.map(function(t){t.initialValue=e[t.name]}),o[0].selectedRowKeys=[e.storeGradeId],o[0].selectedRows=o[0].data.filter(function(t){return t.gradeId==e.storeGradeId}),s.map(function(t){t.initialValue=e[t.name]}),d[0].selected_keys=e.sel_cat_id_array,a.select_cat_id=e.goodsCategoryIds.split(","),a.setState({base_info:n,store_grade_data:o,open_time_data:s,select_cat:d}))},a.handleNextStep=function(e){e.preventDefault();var t=a.state,n=t.store_grade_data,o=t.select_cat,s=a.props.dispatch;a.props.form.validateFieldsAndScroll(function(e,t){if(!e){var l=(0,c.default)({},t);if(0==n[0].selectedRowKeys.length)return(0,b.failTip)("".concat((0,b.sldComLanguage)("\u8bf7\u9009\u62e9\u5e97\u94fa\u7b49\u7ea7\uff5e"))),!1;if(0==a.select_cat_id.length)return(0,b.failTip)("".concat((0,b.sldComLanguage)("\u8bf7\u9009\u62e9\u7ecf\u8425\u7c7b\u578b\uff5e"))),!1;l.goodsCategoryIds=a.select_cat_id.join(","),l.storeGradeId=n[0].selectedRowKeys[0];var r=JSON.parse(localStorage.getItem("baseInfo").replace(/&quot;/g,'"'));(0,b.saveSettleData)("bussinessInfo",JSON.stringify((0,c.default)({},l,{sel_cat_id_array:o[0].selected_keys})));var i=(0,c.default)({},l);i.companyAddress=r.companyAddress,i.companyProvinceCode=r.companyProvinceCode,i.companyCityCode=r.companyCityCode,i.companyAreaCode=r.companyAreaCode,i.areaInfo=r.areaInfo,i.contactName=r.contactName,i.contactPhone=r.contactPhone,i.enterType=r.enterType,i.personCardDown=r.personCardDown,i.personCardUp=r.personCardUp,1==i.enterType&&(i.companyName=r.companyName,i.businessLicenseImage=r.businessLicenseImage,i.moreQualification1=r.moreQualification1?r.moreQualification1:"",i.moreQualification2=r.moreQualification2?r.moreQualification2:"",i.moreQualification3=r.moreQualification3?r.moreQualification3:""),1*(0,b.getSettleData)("cur_step")<3&&(0,b.saveSettleData)("cur_step",3),s({type:"settled/save_apply",payload:i,callback:function(e){200==e.state?((0,b.saveSettleData)("cur_step",3),d.default.success(e.msg),setTimeout(function(){a.props.history.push("/apply/open_up")},1500)):d.default.error(e.msg)}})}})},a.state={base_info:[{type:"input",label:"".concat((0,b.sldComLanguage)("\u5e97\u94fa\u540d\u79f0")),name:"storeName",placeholder:"".concat((0,b.sldComLanguage)("\u8bf7\u8f93\u5165\u5e97\u94fa\u540d\u79f0,\u6700\u591a10\u4e2a\u5b57")),initialValue:"",required:!0,maxLength:10,rules:[{required:!0,message:"".concat((0,b.sldComLanguage)("\u8bf7\u8f93\u5165\u5e97\u94fa\u540d\u79f0"))}]}],store_grade_data:[{type:"scroll_table",label:"".concat((0,b.sldComLanguage)("\u5e97\u94fa\u7b49\u7ea7")),name:"grade",data:[],width:600,columns:a.store_grade_column,rowKey:"gradeId",item_height:300,scroll_height:200,required:!0,handleSelectRows:a.handleSelectGrade,selectedRows:a.selectedRows,selectedRowKeys:a.selectedRowKeys}],open_time_data:[{type:"select",label:"".concat((0,b.sldComLanguage)("\u5f00\u5e97\u65f6\u957f")),name:"applyYear",placeholder:"".concat((0,b.sldComLanguage)("\u8bf7\u9009\u62e9\u5f00\u5e97\u65f6\u957f")),sel_data:[],required:!0,rules:[{required:!0,message:"".concat((0,b.sldComLanguage)("\u8bf7\u9009\u62e9\u5f00\u5e97\u65f6\u957f"))}]}],select_cat:[{width:200,type:"select_cat",label:"".concat((0,b.sldComLanguage)("\u7ecf\u8425\u7c7b\u578b")),name:"goodsCategoryIds",item_height:300,placeholder:"",tree_data:[],selected_keys:[],onCheck:a.handleCatCheck,required:!0}],company_qualification:{}},a}return(0,g.default)(t,e),(0,u.default)(t,[{key:"componentDidMount",value:function(){var e=(0,r.default)(l.default.mark(function e(){return l.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.getStoreGrade(),this.getStoreOpenTime(),e.next=4,this.getSystemCat();case 4:this.initData();case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=this.state,t=e.base_info,a=e.open_time_data,n=e.store_grade_data,o=e.select_cat;return v.default.createElement("div",{style:{flex:1}},v.default.createElement("div",{className:S.default.title},(0,b.sldLlineRtextAddGoodsAddMargin)("#69A2F2","".concat((0,b.sldComLanguage)("\u7ecf\u8425\u4fe1\u606f")),0,0,5)),(0,b.getSldEmptyH)(10),v.default.createElement(k.Scrollbars,{autoHeight:!0,autoHeightMin:100,autoHeightMax:document.body.clientHeight-130},v.default.createElement("div",{className:S.default.commen_wrap},v.default.createElement(x.default,{form:this.props.form,data:t}),v.default.createElement(x.default,{form:this.props.form,data:n}),v.default.createElement(x.default,{form:this.props.form,data:a}),v.default.createElement(x.default,{form:this.props.form,data:o}),((0,b.getSettleData)("state")&&3==(0,b.getSettleData)("state")||!(0,b.getSettleData)("state"))&&v.default.createElement("div",{className:S.default.commen_wrap,style:{borderTopRightRadius:0,borderTopLeftRadius:0,marginTop:-30,paddingBottom:20,textAlign:"center"}},v.default.createElement(s.default,{type:"primary",onClick:this.handleNextStep,className:S.default.next_step},"\u63d0\u4ea4"))),(0,b.getSldEmptyH)(10)))}}]),t}(v.Component),h=y))||h)||h);t.default=I}}]);